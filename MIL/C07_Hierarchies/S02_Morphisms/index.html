<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.31"><title>S02 Morphisms - MIL</title><link rel=stylesheet href=../../../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/css/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=light-green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#morphisms class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=MIL class="md-header__button md-logo" aria-label=MIL data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> MIL </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> S02 Morphisms </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hmyuuu/MIL-zh-demo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> MIL-zh-demo </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../en/ class=md-tabs__link> 目录 </a> </li> <li class=md-tabs__item> <a href=../../../en/C01_Introduction/ class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=../../../en/C02_Basics/ class=md-tabs__link> Basics </a> </li> <li class=md-tabs__item> <a href=../../../en/C03_Logic/ class=md-tabs__link> Logic </a> </li> <li class=md-tabs__item> <a href=../../../en/C04_Sets_and_Functions/ class=md-tabs__link> Sets and Functions </a> </li> <li class=md-tabs__item> <a href=../../../en/C05_Elementary_Number_Theory/ class=md-tabs__link> Elementary Number Theory </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=MIL class="md-nav__button md-logo" aria-label=MIL data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> MIL </label> <div class=md-nav__source> <a href=https://github.com/hmyuuu/MIL-zh-demo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> MIL-zh-demo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../en/ class=md-nav__link> <span class=md-ellipsis> 目录 </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C01_Introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C02_Basics/ class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C03_Logic/ class=md-nav__link> <span class=md-ellipsis> Logic </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C04_Sets_and_Functions/ class=md-nav__link> <span class=md-ellipsis> Sets and Functions </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C05_Elementary_Number_Theory/ class=md-nav__link> <span class=md-ellipsis> Elementary Number Theory </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#morphisms class=md-nav__link> <span class=md-ellipsis> Morphisms </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>S02 Morphisms</h1> <p>import MIL.Common import Mathlib.Topology.Instances.Real</p> <p>set_option autoImplicit true</p> <p>/- TEXT: .. _section_hierarchies_morphisms:</p> <h2 id=morphisms>Morphisms<a class=headerlink href=#morphisms title="Permanent link">&para;</a></h2> <p>So far in this chapter, we discussed how to create a hierarchy of mathematical structures. But defining structures is not really completed until we have morphisms. There are two main approaches here. The most obvious one is to define a predicate on functions. BOTH: -/</p> <p>-- QUOTE: def isMonoidHom₁ [Monoid G] [Monoid H] (f : G → H) : Prop := f 1 = 1 ∧ ∀ g g', f (g * g') = f g * f g' -- QUOTE. /- TEXT: In this definition, it is a bit unpleasant to use a conjunction. In particular users will need to remember the ordering we chose when they want to access the two conditions. So we could use a structure instead.</p> <p>BOTH: -/ -- QUOTE: structure isMonoidHom₂ [Monoid G] [Monoid H] (f : G → H) : Prop where map_one : f 1 = 1 map_mul : ∀ g g', f (g * g') = f g * f g' -- QUOTE. /- TEXT: Once we are here, it is even tempting to make it a class and use the type class instance resolution procedure to automatically infer <code>isMonoidHom₂</code> for complicated functions out of instances for simpler functions. For instance a composition of monoid morphisms is a monoid morphism and this seems like a useful instance. However such an instance would be very tricky for the resolution procedure since it would need to hunt down <code>g ∘ f</code> everywhere. Seeing it failing in <code>g (f x)</code> would be very frustrating. More generally one must always keep in mind that recognizing which function is applied in a given expression is a very difficult problem, called the "higher-order unification problem". So Mathlib does not use this class approach.</p> <p>A more fundamental question is whether we use predicates as above (using either a <code>def</code> or a <code>structure</code>) or use structures bundling a function and predicates. This is partly a psychological issue. It is extremely rare to consider a function between monoids that is not a morphism. It really feels like "monoid morphism" is not an adjective you can assign to a bare function, it is a noun. On the other hand one can argue that a continuous function between topological spaces is really a function that happens to be continuous. This is one reason why Mathlib has a <code>Continuous</code> predicate. For instance you can write:</p> <p>BOTH: -/ -- QUOTE: example : Continuous (id : ℝ → ℝ) := continuous_id -- QUOTE. /- TEXT: We still have bundles continuous functions, which are convenient for instance to put a topology on a space of continuous functions, but they are not the primary tool to work with continuity.</p> <p>By contrast, morphisms between monoids (or other algebraic structures) are bundled as in:</p> <p>BOTH: -/ -- QUOTE: @[ext] structure MonoidHom₁ (G H : Type) [Monoid G] [Monoid H] where toFun : G → H map_one : toFun 1 = 1 map_mul : ∀ g g', toFun (g * g') = toFun g * toFun g'</p> <p>-- QUOTE. /- TEXT: Of course we don't want to type <code>toFun</code> everywhere so we register a coercion using the <code>CoeFun</code> type class. Its first argument is the type we want to coerce to a function. The second argument describes the target function type. In our case it is always <code>G → H</code> for every <code>f : MonoidHom₁ G H</code>. We also tag <code>MonoidHom₁.toFun</code> with the <code>coe</code> attribute to make sure it is displayed almost invisibly in the tactic state, simply by a <code>↑</code> prefix.</p> <p>BOTH: -/ -- QUOTE: instance [Monoid G] [Monoid H] : CoeFun (MonoidHom₁ G H) (fun _ ↦ G → H) where coe := MonoidHom₁.toFun</p> <p>attribute [coe] MonoidHom₁.toFun -- QUOTE.</p> <p>/- TEXT: Let us check we can indeed apply a bundled monoid morphism to an element.</p> <p>BOTH: -/</p> <p>-- QUOTE: example [Monoid G] [Monoid H] (f : MonoidHom₁ G H) : f 1 = 1 := f.map_one -- QUOTE. /- TEXT: We can do the same with other kind of morphisms until we reach ring morphisms.</p> <p>BOTH: -/</p> <p>-- QUOTE: @[ext] structure AddMonoidHom₁ (G H : Type) [AddMonoid G] [AddMonoid H] where toFun : G → H map_zero : toFun 0 = 0 map_add : ∀ g g', toFun (g + g') = toFun g + toFun g'</p> <p>instance [AddMonoid G] [AddMonoid H] : CoeFun (AddMonoidHom₁ G H) (fun _ ↦ G → H) where coe := AddMonoidHom₁.toFun</p> <p>attribute [coe] AddMonoidHom₁.toFun</p> <p>@[ext] structure RingHom₁ (R S : Type) [Ring R] [Ring S] extends MonoidHom₁ R S, AddMonoidHom₁ R S</p> <p>-- QUOTE.</p> <p>/- TEXT: There are a couple of issues about this approach. A minor one is we don't quite know where to put the <code>coe</code> attribute since the <code>RingHom₁.toFun</code> does not exist, the relevant function is <code>MonoidHom₁.toFun ∘ RingHom₁.toMonoidHom₁</code> which is not a declaration that can be tagged with an attribute (but we could still define a <code>CoeFun (RingHom₁ R S) (fun _ ↦ R → S)</code> instance). A much more important one is that lemmas about monoid morphisms won't directly apply to ring morphisms. This leaves the alternative of either juggling with <code>RingHom₁.toMonoidHom₁</code> each time we want to apply a monoid morphism lemma or restate every such lemmas for ring morphisms. Neither option is appealing so Mathlib uses a new hierarchy trick here. The idea is to define a type class for objects that are at least monoid morphisms, instantiate that class with both monoid morphisms and ring morphisms and use it to state every lemma. In the definition below, <code>F</code> could be <code>MonoidHom₁ M N</code>, or <code>RingHom₁ M N</code> if <code>M</code> and <code>N</code> have a ring structure.</p> <p>BOTH: -/</p> <p>-- QUOTE: class MonoidHomClass₁ (F : Type) (M N : Type) [Monoid M] [Monoid N] where toFun : F → M → N map_one : ∀ f : F, toFun f 1 = 1 map_mul : ∀ f g g', toFun f (g * g') = toFun f g * toFun f g' -- QUOTE.</p> <p>/- TEXT: However there is a problem with the above implementation. We haven't registered a coercion to function instance yet. Let us try to do it now.</p> <p>BOTH: -/</p> <p>-- QUOTE: def badInst [Monoid M] [Monoid N] [MonoidHomClass₁ F M N] : CoeFun F (fun _ ↦ M → N) where coe := MonoidHomClass₁.toFun -- QUOTE.</p> <p>/- TEXT: Making this an instance would be bad. When faced with something like <code>f x</code> where the type of <code>f</code> is not a function type, Lean will try to find a <code>CoeFun</code> instance to coerce <code>f</code> into a function. The above function has type: <code>{M N F : Type} → [Monoid M] → [Monoid N] → [MonoidHomClass₁ F M N] → CoeFun F (fun x ↦ M → N)</code> so, when it trying to apply it, it wouldn't be a priori clear to Lean in which order the unknown types <code>M</code>, <code>N</code> and <code>F</code> should be inferred. This is a kind of bad instance that is slightly different from the one we saw already, but it boils down to the same issue: without knowing <code>M</code>, Lean would have to search for a monoid instance on an unknown type, hence hopelessly try <em>every</em> monoid instance in the database. If you are curious to see the effect of such an instance you can type <code>set_option synthInstance.checkSynthOrder false in</code> on top of the above declaration, replace <code>def badInst</code> with <code>instance</code>, and look for random failures in this file.</p> <p>Here the solution is easy, we need to tell Lean to first search what is <code>F</code> and then deduce <code>M</code> and <code>N</code>. This is done using the <code>outParam</code> function. This function is defined as the identity function, but is still recognized by the type class machinery and triggers the desired behavior. Hence we can retry defining our class, paying attention to the <code>outParam</code> function: BOTH: -/</p> <p>-- QUOTE: class MonoidHomClass₂ (F : Type) (M N : outParam Type) [Monoid M] [Monoid N] where toFun : F → M → N map_one : ∀ f : F, toFun f 1 = 1 map_mul : ∀ f g g', toFun f (g * g') = toFun f g * toFun f g'</p> <p>instance [Monoid M] [Monoid N] [MonoidHomClass₂ F M N] : CoeFun F (fun _ ↦ M → N) where coe := MonoidHomClass₂.toFun</p> <p>attribute [coe] MonoidHomClass₂.toFun -- QUOTE.</p> <p>/- TEXT: Now we can proceed with our plan to instantiate this class.</p> <p>BOTH: -/</p> <p>-- QUOTE: instance (M N : Type) [Monoid M] [Monoid N] : MonoidHomClass₂ (MonoidHom₁ M N) M N where toFun := MonoidHom₁.toFun map_one := fun f ↦ f.map_one map_mul := fun f ↦ f.map_mul</p> <p>instance (R S : Type) [Ring R] [Ring S] : MonoidHomClass₂ (RingHom₁ R S) R S where toFun := fun f ↦ f.toMonoidHom₁.toFun map_one := fun f ↦ f.toMonoidHom₁.map_one map_mul := fun f ↦ f.toMonoidHom₁.map_mul -- QUOTE.</p> <p>/- TEXT: As promised every lemma we prove about <code>f : F</code> assuming an instance of <code>MonoidHomClass₁ F</code> will apply both to monoid morphisms and ring morphisms. Let us see an example lemma and check it applies to both situations. BOTH: -/</p> <p>-- QUOTE: lemma map_inv_of_inv [Monoid M] [Monoid N] [MonoidHomClass₂ F M N] (f : F) {m m' : M} (h : m*m' = 1) : f m * f m' = 1 := by rw [← MonoidHomClass₂.map_mul, h, MonoidHomClass₂.map_one]</p> <p>example [Monoid M] [Monoid N] (f : MonoidHom₁ M N) {m m' : M} (h : m*m' = 1) : f m * f m' = 1 := map_inv_of_inv f h</p> <p>example [Ring R] [Ring S] (f : RingHom₁ R S) {r r' : R} (h : r*r' = 1) : f r * f r' = 1 := map_inv_of_inv f h</p> <p>-- QUOTE.</p> <p>/- TEXT: At first sight, it may look like we got back to our old bad idea of making <code>MonoidHom₁</code> a class. But we haven't. Everything is shifted one level of abstraction up. The type class resolution procedure won't be looking for functions, it will be looking for either <code>MonoidHom₁</code> or <code>RingHom₁</code>.</p> <p>One remaining issue with our approach is the presence of repetitive code around the <code>toFun</code> field and the corresponding <code>CoeFun</code> instance and <code>coe</code> attribute. It would also be better to record that this pattern is used only for functions with extra properties, meaning that the coercion to functions should be injective. So Mathlib adds one more layer of abstraction with the base class <code>DFunLike</code> (where “DFun” stands for dependent function). Let us redefine our <code>MonoidHomClass</code> on top of this base layer.</p> <p>BOTH: -/</p> <p>-- QUOTE: class MonoidHomClass₃ (F : Type) (M N : outParam Type) [Monoid M] [Monoid N] extends DFunLike F M (fun _ ↦ N) where map_one : ∀ f : F, f 1 = 1 map_mul : ∀ (f : F) g g', f (g * g') = f g * f g'</p> <p>instance (M N : Type) [Monoid M] [Monoid N] : MonoidHomClass₃ (MonoidHom₁ M N) M N where coe := MonoidHom₁.toFun coe_injective' := MonoidHom₁.ext map_one := MonoidHom₁.map_one map_mul := MonoidHom₁.map_mul -- QUOTE.</p> <p>/- TEXT: Of course the hierarchy of morphisms does not stop here. We could go on and define a class <code>RingHomClass₃</code> extending <code>MonoidHomClass₃</code> and instantiate it on <code>RingHom</code> and then later on <code>AlgebraHom</code> (algebras are rings with some extra structure). But we've covered the main formalization ideas used in Mathlib for morphisms and you should be ready to understand how morphisms are defined in Mathlib.</p> <p>As an exercise, you should try to define your class of bundled order-preserving function between ordered types, and then order preserving monoid morphisms. This is for training purposes only. Like continuous functions, order preserving functions are primarily unbundled in Mathlib where they are defined by the <code>Monotone</code> predicate. Of course you need to complete the class definitions below. BOTH: -/</p> <p>-- QUOTE: @[ext] structure OrderPresHom (α β : Type) [LE α] [LE β] where toFun : α → β le_of_le : ∀ a a', a ≤ a' → toFun a ≤ toFun a'</p> <p>@[ext] structure OrderPresMonoidHom (M N : Type) [Monoid M] [LE M] [Monoid N] [LE N] extends MonoidHom₁ M N, OrderPresHom M N</p> <p>class OrderPresHomClass (F : Type) (α β : outParam Type) [LE α] [LE β] -- SOLUTIONS: extends DFunLike F α (fun _ ↦ β) where le_of_le : ∀ (f : F) a a', a ≤ a' → f a ≤ f a' -- BOTH:</p> <p>instance (α β : Type) [LE α] [LE β] : OrderPresHomClass (OrderPresHom α β) α β where -- SOLUTIONS: coe := OrderPresHom.toFun coe_injective' := OrderPresHom.ext le_of_le := OrderPresHom.le_of_le -- BOTH:</p> <p>instance (α β : Type) [LE α] [Monoid α] [LE β] [Monoid β] : OrderPresHomClass (OrderPresMonoidHom α β) α β where -- SOLUTIONS: coe := fun f ↦ f.toOrderPresHom.toFun coe_injective' := OrderPresMonoidHom.ext le_of_le := fun f ↦ f.toOrderPresHom.le_of_le -- BOTH:</p> <p>instance (α β : Type) [LE α] [Monoid α] [LE β] [Monoid β] : MonoidHomClass₃ (OrderPresMonoidHom α β) α β /- EXAMPLES: := sorry SOLUTIONS: -/ where coe := fun f ↦ f.toOrderPresHom.toFun coe_injective' := OrderPresMonoidHom.ext map_one := fun f ↦ f.toMonoidHom₁.map_one map_mul := fun f ↦ f.toMonoidHom₁.map_mul -- QUOTE.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.fe8b6f2b.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>