<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.31"><title>S01 Structures - MIL</title><link rel=stylesheet href=../../../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/css/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=light-green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#defining-structures class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=MIL class="md-header__button md-logo" aria-label=MIL data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> MIL </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> S01 Structures </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hmyuuu/MIL-zh-demo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> MIL-zh-demo </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../en/ class=md-tabs__link> 目录 </a> </li> <li class=md-tabs__item> <a href=../../../en/C01_Introduction/ class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=../../../en/C02_Basics/ class=md-tabs__link> Basics </a> </li> <li class=md-tabs__item> <a href=../../../en/C03_Logic/ class=md-tabs__link> Logic </a> </li> <li class=md-tabs__item> <a href=../../../en/C04_Sets_and_Functions/ class=md-tabs__link> Sets and Functions </a> </li> <li class=md-tabs__item> <a href=../../../en/C05_Elementary_Number_Theory/ class=md-tabs__link> Elementary Number Theory </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=MIL class="md-nav__button md-logo" aria-label=MIL data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> MIL </label> <div class=md-nav__source> <a href=https://github.com/hmyuuu/MIL-zh-demo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> MIL-zh-demo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../en/ class=md-nav__link> <span class=md-ellipsis> 目录 </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C01_Introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C02_Basics/ class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C03_Logic/ class=md-nav__link> <span class=md-ellipsis> Logic </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C04_Sets_and_Functions/ class=md-nav__link> <span class=md-ellipsis> Sets and Functions </span> </a> </li> <li class=md-nav__item> <a href=../../../en/C05_Elementary_Number_Theory/ class=md-nav__link> <span class=md-ellipsis> Elementary Number Theory </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#defining-structures class=md-nav__link> <span class=md-ellipsis> Defining structures </span> </a> </li> <li class=md-nav__item> <a href=#check-pointext class=md-nav__link> <span class=md-ellipsis> check Point.ext </span> </a> </li> <li class=md-nav__item> <a href=#check-pointbuild-2-1-4 class=md-nav__link> <span class=md-ellipsis> check Point'.build 2 (-1) 4 </span> </a> </li> <li class=md-nav__item> <a href=#check-add-mypoint1-mypoint2 class=md-nav__link> <span class=md-ellipsis> check add myPoint1 myPoint2 </span> </a> </li> <li class=md-nav__item> <a href=#check-mypoint1add-mypoint2 class=md-nav__link> <span class=md-ellipsis> check myPoint1.add myPoint2 </span> </a> </li> <li class=md-nav__item> <a href=#check-pointadd-mypoint1-mypoint2 class=md-nav__link> <span class=md-ellipsis> check Point.add myPoint1 myPoint2 </span> </a> </li> <li class=md-nav__item> <a href=#check-mypoint1add-mypoint2_1 class=md-nav__link> <span class=md-ellipsis> check myPoint1.add myPoint2 </span> </a> </li> <li class=md-nav__item> <a href=#check-linfis_additive class=md-nav__link> <span class=md-ellipsis> check linf.is_additive </span> </a> </li> <li class=md-nav__item> <a href=#check-linfpreserves_mul class=md-nav__link> <span class=md-ellipsis> check linf.preserves_mul </span> </a> </li> <li class=md-nav__item> <a href=#check-xval class=md-nav__link> <span class=md-ellipsis> check x.val </span> </a> </li> <li class=md-nav__item> <a href=#check-xproperty class=md-nav__link> <span class=md-ellipsis> check x.property </span> </a> </li> <li class=md-nav__item> <a href=#check-x1 class=md-nav__link> <span class=md-ellipsis> check x.1 </span> </a> </li> <li class=md-nav__item> <a href=#check-x2 class=md-nav__link> <span class=md-ellipsis> check x.2 </span> </a> </li> <li class=md-nav__item> <a href=#check-sfst class=md-nav__link> <span class=md-ellipsis> check s.fst </span> </a> </li> <li class=md-nav__item> <a href=#check-ssnd class=md-nav__link> <span class=md-ellipsis> check s.snd </span> </a> </li> <li class=md-nav__item> <a href=#check-s1 class=md-nav__link> <span class=md-ellipsis> check s.1 </span> </a> </li> <li class=md-nav__item> <a href=#check-s2 class=md-nav__link> <span class=md-ellipsis> check s.2 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <p>import MIL.Common import Mathlib.Algebra.BigOperators.Ring import Mathlib.Data.Real.Basic</p> <p>namespace C06S01 noncomputable section</p> <p>/- TEXT: .. _section_structures:</p> <h2 id=defining-structures>Defining structures<a class=headerlink href=#defining-structures title="Permanent link">&para;</a></h2> <p>In the broadest sense of the term, a <em>structure</em> is a specification of a collection of data, possibly with constraints that the data is required to satisfy. An <em>instance</em> of the structure is a particular bundle of data satisfying the constraints. For example, we can specify that a point is a tuple of three real numbers: BOTH: -/ -- QUOTE: @[ext] structure Point where x : ℝ y : ℝ z : ℝ -- QUOTE.</p> <p>/- TEXT: The <code>@[ext]</code> annotation tells Lean to automatically generate theorems that can be used to prove that two instances of a structure are equal when their components are equal, a property known as <em>extensionality</em>. EXAMPLES: -/ -- QUOTE:</p> <h1 id=check-pointext>check Point.ext<a class=headerlink href=#check-pointext title="Permanent link">&para;</a></h1> <p>example (a b : Point) (hx : a.x = b.x) (hy : a.y = b.y) (hz : a.z = b.z) : a = b := by ext repeat' assumption -- QUOTE.</p> <p>/- TEXT: We can then define particular instances of the <code>Point</code> structure. Lean provides multiple ways of doing that. EXAMPLES: -/ -- QUOTE: def myPoint1 : Point where x := 2 y := -1 z := 4</p> <p>def myPoint2 : Point := ⟨2, -1, 4⟩</p> <p>def myPoint3 := Point.mk 2 (-1) 4 -- QUOTE.</p> <p>/- TEXT: .. Because Lean knows that the expected type of <code>myPoint1</code> is a <code>Point</code>, you can start the definition by writing an underscore, <code>_</code>. Clicking on the light bulb that appears nearby in VS Code will then give you the option of inserting a template definition with the field names listed for you.</p> <p>In the first example, the fields of the structure are named explicitly. The function <code>Point.mk</code> referred to in the definition of <code>myPoint3</code> is known as the <em>constructor</em> for the <code>Point</code> structure, because it serves to construct elements. You can specify a different name if you want, like <code>build</code>. EXAMPLES: -/ -- QUOTE: structure Point' where build :: x : ℝ y : ℝ z : ℝ</p> <h1 id=check-pointbuild-2-1-4>check Point'.build 2 (-1) 4<a class=headerlink href=#check-pointbuild-2-1-4 title="Permanent link">&para;</a></h1> <p>-- QUOTE.</p> <p>/- TEXT: The next two examples show how to define functions on structures. Whereas the second example makes the <code>Point.mk</code> constructor explicit, the first example uses an anonymous constructor for brevity. Lean can infer the relevant constructor from the indicated type of <code>add</code>. It is conventional to put definitions and theorems associated with a structure like <code>Point</code> in a namespace with the same name. In the example below, because we have opened the <code>Point</code> namespace, the full name of <code>add</code> is <code>Point.add</code>. When the namespace is not open, we have to use the full name. But remember that it is often convenient to use anonymous projection notation, which allows us to write <code>a.add b</code> instead of <code>Point.add a b</code>. Lean interprets the former as the latter because <code>a</code> has type <code>Point</code>. BOTH: -/ -- QUOTE: namespace Point</p> <p>def add (a b : Point) : Point := ⟨a.x + b.x, a.y + b.y, a.z + b.z⟩</p> <p>-- EXAMPLES: def add' (a b : Point) : Point where x := a.x + b.x y := a.y + b.y z := a.z + b.z</p> <h1 id=check-add-mypoint1-mypoint2>check add myPoint1 myPoint2<a class=headerlink href=#check-add-mypoint1-mypoint2 title="Permanent link">&para;</a></h1> <h1 id=check-mypoint1add-mypoint2>check myPoint1.add myPoint2<a class=headerlink href=#check-mypoint1add-mypoint2 title="Permanent link">&para;</a></h1> <p>end Point</p> <h1 id=check-pointadd-mypoint1-mypoint2>check Point.add myPoint1 myPoint2<a class=headerlink href=#check-pointadd-mypoint1-mypoint2 title="Permanent link">&para;</a></h1> <h1 id=check-mypoint1add-mypoint2_1>check myPoint1.add myPoint2<a class=headerlink href=#check-mypoint1add-mypoint2_1 title="Permanent link">&para;</a></h1> <p>-- QUOTE.</p> <p>/- TEXT: Below we will continue to put definitions in the relevant namespace, but we will leave the namespacing commands out of the quoted snippets. To prove properties of the addition function, we can use <code>rw</code> to expand the definition and <code>ext</code> to reduce an equation between two elements of the structure to equations between the components. Below we use the <code>protected</code> keyword so that the name of the theorem is <code>Point.add_comm</code>, even when the namespace is open. This is helpful when we want to avoid ambiguity with a generic theorem like <code>add_comm</code>. EXAMPLES: -/ namespace Point</p> <p>-- QUOTE: protected theorem add_comm (a b : Point) : add a b = add b a := by rw [add, add] ext &lt;;&gt; dsimp repeat' apply add_comm</p> <p>example (a b : Point) : add a b = add b a := by simp [add, add_comm] -- QUOTE.</p> <p>/- TEXT: Because Lean can unfold definitions and simplify projections internally, sometimes the equations we want hold definitionally. EXAMPLES: -/ -- QUOTE: theorem add_x (a b : Point) : (a.add b).x = a.x + b.x := rfl -- QUOTE.</p> <p>/- TEXT: It is also possible to define functions on structures using pattern matching, in a manner similar to the way we defined recursive functions in :numref:<code>section_induction_and_recursion</code>. The definitions <code>addAlt</code> and <code>addAlt'</code> below are essentially the same; the only difference is that we use anonymous constructor notation in the second. Although it is sometimes convenient to define functions this way, and structural eta-reduction makes this alternative definitionally equivalent, it can make things less convenient in later proofs. In particular, <code>rw [addAlt]</code> leaves us with a messier goal view containing a <code>match</code> statement. EXAMPLES: -/ -- QUOTE: def addAlt : Point → Point → Point | Point.mk x₁ y₁ z₁, Point.mk x₂ y₂ z₂ =&gt; ⟨x₁ + x₂, y₁ + y₂, z₁ + z₂⟩</p> <p>def addAlt' : Point → Point → Point | ⟨x₁, y₁, z₁⟩, ⟨x₂, y₂, z₂⟩ =&gt; ⟨x₁ + x₂, y₁ + y₂, z₁ + z₂⟩</p> <p>theorem addAlt_x (a b : Point) : (a.addAlt b).x = a.x + b.x := by rfl</p> <p>theorem addAlt_comm (a b : Point) : addAlt a b = addAlt b a := by rw [addAlt, addAlt] -- the same proof still works, but the goal view here is harder to read ext &lt;;&gt; dsimp repeat' apply add_comm -- QUOTE.</p> <p>/- TEXT: Mathematical constructions often involve taking apart bundled information and putting it together again in different ways. It therefore makes sense that Lean and Mathlib offer so many ways of doing this efficiently. As an exercise, try proving that <code>Point.add</code> is associative. Then define scalar multiplication for a point and show that it distributes over addition. BOTH: -/ -- QUOTE: protected theorem add_assoc (a b c : Point) : (a.add b).add c = a.add (b.add c) := by /- EXAMPLES: sorry SOLUTIONS: -/ simp [add, add_assoc] -- BOTH:</p> <p>def smul (r : ℝ) (a : Point) : Point := /- EXAMPLES: sorry SOLUTIONS: -/ ⟨r * a.x, r * a.y, r * a.z⟩ -- BOTH:</p> <p>theorem smul_distrib (r : ℝ) (a b : Point) : (smul r a).add (smul r b) = smul r (a.add b) := by /- EXAMPLES: sorry SOLUTIONS: -/ simp [add, smul, mul_add] -- BOTH: -- QUOTE.</p> <p>end Point</p> <p>/- TEXT: Using structures is only the first step on the road to algebraic abstraction. We don't yet have a way to link <code>Point.add</code> to the generic <code>+</code> symbol, or to connect <code>Point.add_comm</code> and <code>Point.add_assoc</code> to the generic <code>add_comm</code> and <code>add_assoc</code> theorems. These tasks belong to the <em>algebraic</em> aspect of using structures, and we will explain how to carry them out in the next section. For now, just think of a structure as a way of bundling together objects and information.</p> <p>It is especially useful that a structure can specify not only data types but also constraints that the data must satisfy. In Lean, the latter are represented as fields of type <code>Prop</code>. For example, the <em>standard 2-simplex</em> is defined to be the set of points :math:<code>(x, y, z)</code> satisfying :math:<code>x ≥ 0</code>, :math:<code>y ≥ 0</code>, :math:<code>z ≥ 0</code>, and :math:<code>x + y + z = 1</code>. If you are not familiar with the notion, you should draw a picture, and convince yourself that this set is the equilateral triangle in three-space with vertices :math:<code>(1, 0, 0)</code>, :math:<code>(0, 1, 0)</code>, and :math:<code>(0, 0, 1)</code>, together with its interior. We can represent it in Lean as follows: BOTH: -/ -- QUOTE: structure StandardTwoSimplex where x : ℝ y : ℝ z : ℝ x_nonneg : 0 ≤ x y_nonneg : 0 ≤ y z_nonneg : 0 ≤ z sum_eq : x + y + z = 1 -- QUOTE.</p> <p>/- TEXT: Notice that the last four fields refer to <code>x</code>, <code>y</code>, and <code>z</code>, that is, the first three fields. We can define a map from the two-simplex to itself that swaps <code>x</code> and <code>y</code>: BOTH: -/ namespace StandardTwoSimplex</p> <p>-- EXAMPLES: -- QUOTE: def swapXy (a : StandardTwoSimplex) : StandardTwoSimplex where x := a.y y := a.x z := a.z x_nonneg := a.y_nonneg y_nonneg := a.x_nonneg z_nonneg := a.z_nonneg sum_eq := by rw [add_comm a.y a.x, a.sum_eq] -- QUOTE.</p> <p>-- OMIT: (TODO) add a link when we have a good explanation of noncomputable section. /- TEXT: More interestingly, we can compute the midpoint of two points on the simplex. We have added the phrase <code>noncomputable section</code> at the beginning of this file in order to use division on the real numbers. BOTH: -/ -- QUOTE: noncomputable section</p> <p>-- EXAMPLES: def midpoint (a b : StandardTwoSimplex) : StandardTwoSimplex where x := (a.x + b.x) / 2 y := (a.y + b.y) / 2 z := (a.z + b.z) / 2 x_nonneg := div_nonneg (add_nonneg a.x_nonneg b.x_nonneg) (by norm_num) y_nonneg := div_nonneg (add_nonneg a.y_nonneg b.y_nonneg) (by norm_num) z_nonneg := div_nonneg (add_nonneg a.z_nonneg b.z_nonneg) (by norm_num) sum_eq := by field_simp; linarith [a.sum_eq, b.sum_eq] -- QUOTE.</p> <p>/- TEXT: Here we have established <code>x_nonneg</code>, <code>y_nonneg</code>, and <code>z_nonneg</code> with concise proof terms, but establish <code>sum_eq</code> in tactic mode, using <code>by</code>.</p> <p>Given a parameter :math:<code>\lambda</code> satisfying :math:<code>0 \le \lambda \le 1</code>, we can take the weighted average :math:<code>\lambda a + (1 - \lambda) b</code> of two points :math:<code>a</code> and :math:<code>b</code> in the standard 2-simplex. We challenge you to define that function, in analogy to the <code>midpoint</code> function above. BOTH: -/ -- QUOTE: def weightedAverage (lambda : Real) (lambda_nonneg : 0 ≤ lambda) (lambda_le : lambda ≤ 1) /- EXAMPLES: (a b : StandardTwoSimplex) : StandardTwoSimplex := sorry SOLUTIONS: -/ (a b : StandardTwoSimplex) : StandardTwoSimplex where x := lambda * a.x + (1 - lambda) * b.x y := lambda * a.y + (1 - lambda) * b.y z := lambda * a.z + (1 - lambda) * b.z x_nonneg := add_nonneg (mul_nonneg lambda_nonneg a.x_nonneg) (mul_nonneg (by linarith) b.x_nonneg) y_nonneg := add_nonneg (mul_nonneg lambda_nonneg a.y_nonneg) (mul_nonneg (by linarith) b.y_nonneg) z_nonneg := add_nonneg (mul_nonneg lambda_nonneg a.z_nonneg) (mul_nonneg (by linarith) b.z_nonneg) sum_eq := by trans (a.x + a.y + a.z) * lambda + (b.x + b.y + b.z) * (1 - lambda) · ring simp [a.sum_eq, b.sum_eq] -- QUOTE. -- BOTH:</p> <p>end</p> <p>end StandardTwoSimplex</p> <p>/- TEXT: Structures can depend on parameters. For example, we can generalize the standard 2-simplex to the standard :math:<code>n</code>-simplex for any :math:<code>n</code>. At this stage, you don't have to know anything about the type <code>Fin n</code> except that it has :math:<code>n</code> elements, and that Lean knows how to sum over it. BOTH: -/ -- QUOTE: open BigOperators</p> <p>structure StandardSimplex (n : ℕ) where V : Fin n → ℝ NonNeg : ∀ i : Fin n, 0 ≤ V i sum_eq_one : (∑ i, V i) = 1</p> <p>namespace StandardSimplex</p> <p>def midpoint (n : ℕ) (a b : StandardSimplex n) : StandardSimplex n where V i := (a.V i + b.V i) / 2 NonNeg := by intro i apply div_nonneg · linarith [a.NonNeg i, b.NonNeg i] norm_num sum_eq_one := by simp [div_eq_mul_inv, ← Finset.sum_mul, Finset.sum_add_distrib, a.sum_eq_one, b.sum_eq_one] field_simp</p> <p>end StandardSimplex -- QUOTE.</p> <p>/- TEXT: As an exercise, see if you can define the weighted average of two points in the standard :math:<code>n</code>-simplex. You can use <code>Finset.sum_add_distrib</code> and <code>Finset.mul_sum</code> to manipulate the relevant sums. SOLUTIONS: -/ namespace StandardSimplex</p> <p>def weightedAverage {n : ℕ} (lambda : Real) (lambda_nonneg : 0 ≤ lambda) (lambda_le : lambda ≤ 1) (a b : StandardSimplex n) : StandardSimplex n where V i := lambda * a.V i + (1 - lambda) * b.V i NonNeg i := add_nonneg (mul_nonneg lambda_nonneg (a.NonNeg i)) (mul_nonneg (by linarith) (b.NonNeg i)) sum_eq_one := by trans (lambda * ∑ i, a.V i) + (1 - lambda) * ∑ i, b.V i · rw [Finset.sum_add_distrib, Finset.mul_sum, Finset.mul_sum] simp [a.sum_eq_one, b.sum_eq_one]</p> <p>end StandardSimplex</p> <p>/- TEXT: We have seen that structures can be used to bundle together data and properties. Interestingly, they can also be used to bundle together properties without the data. For example, the next structure, <code>IsLinear</code>, bundles together the two components of linearity. EXAMPLES: -/ -- QUOTE: structure IsLinear (f : ℝ → ℝ) where is_additive : ∀ x y, f (x + y) = f x + f y preserves_mul : ∀ x c, f (c * x) = c * f x</p> <p>section variable (f : ℝ → ℝ) (linf : IsLinear f)</p> <h1 id=check-linfis_additive>check linf.is_additive<a class=headerlink href=#check-linfis_additive title="Permanent link">&para;</a></h1> <h1 id=check-linfpreserves_mul>check linf.preserves_mul<a class=headerlink href=#check-linfpreserves_mul title="Permanent link">&para;</a></h1> <p>end -- QUOTE.</p> <p>/- TEXT: It is worth pointing out that structures are not the only way to bundle together data. The <code>Point</code> data structure can be defined using the generic type product, and <code>IsLinear</code> can be defined with a simple <code>and</code>. EXAMPLES: -/ -- QUOTE: def Point'' := ℝ × ℝ × ℝ</p> <p>def IsLinear' (f : ℝ → ℝ) := (∀ x y, f (x + y) = f x + f y) ∧ ∀ x c, f (c * x) = c * f x -- QUOTE.</p> <p>/- TEXT: Generic type constructions can even be used in place of structures with dependencies between their components. For example, the <em>subtype</em> construction combines a piece of data with a property. You can think of the type <code>PReal</code> in the next example as being the type of positive real numbers. Any <code>x : PReal</code> has two components: the value, and the property of being positive. You can access these components as <code>x.val</code>, which has type <code>ℝ</code>, and <code>x.property</code>, which represents the fact <code>0 &lt; x.val</code>. EXAMPLES: -/ -- QUOTE: def PReal := { y : ℝ // 0 &lt; y }</p> <p>section variable (x : PReal)</p> <h1 id=check-xval>check x.val<a class=headerlink href=#check-xval title="Permanent link">&para;</a></h1> <h1 id=check-xproperty>check x.property<a class=headerlink href=#check-xproperty title="Permanent link">&para;</a></h1> <h1 id=check-x1>check x.1<a class=headerlink href=#check-x1 title="Permanent link">&para;</a></h1> <h1 id=check-x2>check x.2<a class=headerlink href=#check-x2 title="Permanent link">&para;</a></h1> <p>end -- QUOTE.</p> <p>/- TEXT: We could have used subtypes to define the standard 2-simplex, as well as the standard :math:<code>n</code>-simplex for an arbitrary :math:<code>n</code>. EXAMPLES: -/ -- QUOTE: def StandardTwoSimplex' := { p : ℝ × ℝ × ℝ // 0 ≤ p.1 ∧ 0 ≤ p.2.1 ∧ 0 ≤ p.2.2 ∧ p.1 + p.2.1 + p.2.2 = 1 }</p> <p>def StandardSimplex' (n : ℕ) := { v : Fin n → ℝ // (∀ i : Fin n, 0 ≤ v i) ∧ (∑ i, v i) = 1 } -- QUOTE.</p> <p>/- TEXT: Similarly, <em>Sigma types</em> are generalizations of ordered pairs, whereby the type of the second component depends on the type of the first. EXAMPLES: -/ -- QUOTE: def StdSimplex := Σ n : ℕ, StandardSimplex n</p> <p>section variable (s : StdSimplex)</p> <h1 id=check-sfst>check s.fst<a class=headerlink href=#check-sfst title="Permanent link">&para;</a></h1> <h1 id=check-ssnd>check s.snd<a class=headerlink href=#check-ssnd title="Permanent link">&para;</a></h1> <h1 id=check-s1>check s.1<a class=headerlink href=#check-s1 title="Permanent link">&para;</a></h1> <h1 id=check-s2>check s.2<a class=headerlink href=#check-s2 title="Permanent link">&para;</a></h1> <p>end -- QUOTE.</p> <p>/- TEXT: Given <code>s : StdSimplex</code>, the first component <code>s.fst</code> is a natural number, and the second component is an element of the corresponding simplex <code>StandardSimplex s.fst</code>. The difference between a Sigma type and a subtype is that the second component of a Sigma type is data rather than a proposition.</p> <p>But even though we can use products, subtypes, and Sigma types instead of structures, using structures has a number of advantages. Defining a structure abstracts away the underlying representation and provides custom names for the functions that access the components. This makes proofs more robust: proofs that rely only on the interface to a structure will generally continue to work when we change the definition, as long as we redefine the old accessors in terms of the new definition. Moreover, as we are about to see, Lean provides support for weaving structures together into a rich, interconnected hierarchy, and for managing the interactions between them. TEXT. -/ /- OMIT: (TODO) Comments from Patrick: We could make this paragraph much less abstract by showing how to access the components of a point with the definition def point'' := ℝ × ℝ × ℝ. However if we do that it would probably be honest to also mention the possibility of using fin 3 → ℝ as the definition. This interesting anyhow, because I think very few mathematician realize that defining ℝ^n as an iterated cartesian product is a polite lie that would be a nightmare if taken seriously.</p> <p>By the way, should be include some comment about similarities and differences with object-oriented programming? All the examples from that page would clearly fit very well with classes in python say. And we'll have to face the name-clash between classes in Lean and classes in C++ or python sooner or later. Life would be so much simpler if classes in Lean could use another name... OMIT. -/</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.fe8b6f2b.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>