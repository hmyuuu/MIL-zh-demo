<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../C02_Basics/ rel=prev><link href=../C04_Sets_and_Functions/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.31"><title>Logic - MIL</title><link rel=stylesheet href=../../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/css/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=light-green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#logic class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=MIL class="md-header__button md-logo" aria-label=MIL data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> MIL </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Logic </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hmyuuu/MIL-zh-demo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> MIL-zh-demo </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../ class=md-tabs__link> 目录 </a> </li> <li class=md-tabs__item> <a href=../C01_Introduction/ class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=../C02_Basics/ class=md-tabs__link> Basics </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Logic </a> </li> <li class=md-tabs__item> <a href=../C04_Sets_and_Functions/ class=md-tabs__link> Sets and Functions </a> </li> <li class=md-tabs__item> <a href=../C05_Elementary_Number_Theory/ class=md-tabs__link> Elementary Number Theory </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=MIL class="md-nav__button md-logo" aria-label=MIL data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> MIL </label> <div class=md-nav__source> <a href=https://github.com/hmyuuu/MIL-zh-demo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> MIL-zh-demo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> 目录 </span> </a> </li> <li class=md-nav__item> <a href=../C01_Introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../C02_Basics/ class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Logic </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Logic </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#implication-and-the-universal-quantifier class=md-nav__link> <span class=md-ellipsis> Implication and the Universal Quantifier </span> </a> </li> <li class=md-nav__item> <a href=#the-existential-quantifier class=md-nav__link> <span class=md-ellipsis> The Existential Quantifier </span> </a> </li> <li class=md-nav__item> <a href=#negation class=md-nav__link> <span class=md-ellipsis> Negation </span> </a> </li> <li class=md-nav__item> <a href=#conjunction-and-iff class=md-nav__link> <span class=md-ellipsis> Conjunction and Iff </span> </a> </li> <li class=md-nav__item> <a href=#disjunction class=md-nav__link> <span class=md-ellipsis> Disjunction </span> </a> </li> <li class=md-nav__item> <a href=#sequences-and-convergence class=md-nav__link> <span class=md-ellipsis> Sequences and Convergence </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../C04_Sets_and_Functions/ class=md-nav__link> <span class=md-ellipsis> Sets and Functions </span> </a> </li> <li class=md-nav__item> <a href=../C05_Elementary_Number_Theory/ class=md-nav__link> <span class=md-ellipsis> Elementary Number Theory </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#implication-and-the-universal-quantifier class=md-nav__link> <span class=md-ellipsis> Implication and the Universal Quantifier </span> </a> </li> <li class=md-nav__item> <a href=#the-existential-quantifier class=md-nav__link> <span class=md-ellipsis> The Existential Quantifier </span> </a> </li> <li class=md-nav__item> <a href=#negation class=md-nav__link> <span class=md-ellipsis> Negation </span> </a> </li> <li class=md-nav__item> <a href=#conjunction-and-iff class=md-nav__link> <span class=md-ellipsis> Conjunction and Iff </span> </a> </li> <li class=md-nav__item> <a href=#disjunction class=md-nav__link> <span class=md-ellipsis> Disjunction </span> </a> </li> <li class=md-nav__item> <a href=#sequences-and-convergence class=md-nav__link> <span class=md-ellipsis> Sequences and Convergence </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=logic>Logic<a class=headerlink href=#logic title="Permanent link">&para;</a></h1> <p>In the last chapter, we dealt with equations, inequalities, and basic mathematical statements like ":math:<code>x</code> divides :math:<code>y</code>." Complex mathematical statements are built up from simple ones like these using logical terms like "and," "or," "not," and "if ... then," "every," and "some." In this chapter, we show you how to work with statements that are built up in this way.</p> <h2 id=implication-and-the-universal-quantifier>Implication and the Universal Quantifier<a class=headerlink href=#implication-and-the-universal-quantifier title="Permanent link">&para;</a></h2> <p>Consider the statement after the <code>#check</code>:</p> <div class=highlight><pre><span></span><code><span class=k>#check</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>x</span>
</code></pre></div> <p>In words, we would say "for every real number <code>x</code>, if <code>0 ≤ x</code> then the absolute value of <code>x</code> equals <code>x</code>". We can also have more complicated statements like:</p> <div class=highlight><pre><span></span><code><span class=k>#check</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span>
</code></pre></div> <p>In words, we would say "for every <code>x</code>, <code>y</code>, and <code>ε</code>, if <code>0 &lt; ε ≤ 1</code>, the absolute value of <code>x</code> is less than <code>ε</code>, and the absolute value of <code>y</code> is less than <code>ε</code>, then the absolute value of <code>x * y</code> is less than <code>ε</code>." In Lean, in a sequence of implications there are implicit parentheses grouped to the right. So the expression above means "if <code>0 &lt; ε</code> then if <code>ε ≤ 1</code> then if <code>|x| &lt; ε</code> ..." As a result, the expression says that all the assumptions together imply the conclusion.</p> <p>You have already seen that even though the universal quantifier in this statement ranges over objects and the implication arrows introduce hypotheses, Lean treats the two in very similar ways. In particular, if you have proved a theorem of that form, you can apply it to objects and hypotheses in the same way. We will use as an example the following statement that we will help you to prove a bit later:</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>my_lemma</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kn>section</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>δ</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>h₀</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>δ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h₁</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>δ</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>1</span><span class=o>)</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>ha</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>δ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>hb</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>δ</span><span class=o>)</span>

<span class=k>#check</span><span class=w> </span><span class=n>my_lemma</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>δ</span>
<span class=k>#check</span><span class=w> </span><span class=n>my_lemma</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>δ</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span>
<span class=k>#check</span><span class=w> </span><span class=n>my_lemma</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>δ</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=n>ha</span><span class=w> </span><span class=n>hb</span>

<span class=kd>end</span>
</code></pre></div> <p>You have also already seen that it is common in Lean to use curly brackets to make quantified variables implicit when they can be inferred from subsequent hypotheses. When we do that, we can just apply a lemma to the hypotheses without mentioning the objects.</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>my_lemma2</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>},</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kn>section</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>δ</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>h₀</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>δ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h₁</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>δ</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>1</span><span class=o>)</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>ha</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>δ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>hb</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>δ</span><span class=o>)</span>

<span class=k>#check</span><span class=w> </span><span class=n>my_lemma2</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=n>ha</span><span class=w> </span><span class=n>hb</span>

<span class=kd>end</span>
</code></pre></div> <p>At this stage, you also know that if you use the <code>apply</code> tactic to apply <code>my_lemma</code> to a goal of the form <code>|a * b| &lt; δ</code>, you are left with new goals that require you to prove each of the hypotheses.</p> <p>To prove a statement like this, use the <code>intro</code> tactic. Take a look at what it does in this example:</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>my_lemma3</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=bp>∀</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>},</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=n>epos</span><span class=w> </span><span class=n>ele1</span><span class=w> </span><span class=n>xlt</span><span class=w> </span><span class=n>ylt</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>We can use any names we want for the universally quantified variables; they do not have to be <code>x</code>, <code>y</code>, and <code>ε</code>. Notice that we have to introduce the variables even though they are marked implicit: making them implicit means that we leave them out when we write an expression <em>using</em> <code>my_lemma</code>, but they are still an essential part of the statement that we are proving. After the <code>intro</code> command, the goal is what it would have been at the start if we listed all the variables and hypotheses <em>before</em> the colon, as we did in the last section. In a moment, we will see why it is sometimes necessary to introduce variables and hypotheses after the proof begins.</p> <p>To help you prove the lemma, we will start you off:</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>my_lemma4</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=bp>∀</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>},</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=n>epos</span><span class=w> </span><span class=n>ele1</span><span class=w> </span><span class=n>xlt</span><span class=w> </span><span class=n>ylt</span>
<span class=w>  </span><span class=k>calc</span>
<span class=w>    </span><span class=bp>|</span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>    </span><span class=n>_</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>    </span><span class=n>_</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>    </span><span class=n>_</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=gr>sorry</span>
</code></pre></div> <p>Finish the proof using the theorems <code>abs_mul</code>, <code>mul_le_mul</code>, <code>abs_nonneg</code>, <code>mul_lt_mul_right</code>, and <code>one_mul</code>. Remember that you can find theorems like these using Ctrl-space completion (or Cmd-space completion on a Mac). Remember also that you can use <code>.mp</code> and <code>.mpr</code> or <code>.1</code> and <code>.2</code> to extract the two directions of an if-and-only-if statement.</p> <p>Universal quantifiers are often hidden in definitions, and Lean will unfold definitions to expose them when necessary. For example, let's define two predicates, <code>FnUb f a</code> and <code>FnLb f a</code>, where <code>f</code> is a function from the real numbers to the real numbers and <code>a</code> is a real number. The first says that <code>a</code> is an upper bound on the values of <code>f</code>, and the second says that <code>a</code> is a lower bound on the values of <code>f</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>def</span><span class=w> </span><span class=n>FnUb</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>a</span>

<span class=kd>def</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span>
</code></pre></div> <p>In the next example, <code>fun x ↦ f x + g x</code> is the function that maps <code>x</code> to <code>f x + g x</code>. Going from the expression <code>f x + g x</code> to this function is called a lambda abstraction in type theory.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>hfa</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnUb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>hgb</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnUb</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnUb</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>x</span>
<span class=w>  </span><span class=n>dsimp</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>add_le_add</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>hfa</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>hgb</span>
</code></pre></div> <p>Applying <code>intro</code> to the goal <code>FnUb (fun x ↦ f x + g x) (a + b)</code> forces Lean to unfold the definition of <code>FnUb</code> and introduce <code>x</code> for the universal quantifier. The goal is then <code>(fun (x : ℝ) ↦ f x + g x) x ≤ a + b</code>. But applying <code>(fun x ↦ f x + g x)</code> to <code>x</code> should result in <code>f x + g x</code>, and the <code>dsimp</code> command performs that simplification. (The "d" stands for "definitional.") You can delete that command and the proof still works; Lean would have to perform that contraction anyhow to make sense of the next <code>apply</code>. The <code>dsimp</code> command simply makes the goal more readable and helps us figure out what to do next. Another option is to use the <code>change</code> tactic by writing <code>change f x + g x ≤ a + b</code>. This helps make the proof more readable, and gives you more control over how the goal is transformed.</p> <p>The rest of the proof is routine. The last two <code>apply</code> commands force Lean to unfold the definitions of <code>FnUb</code> in the hypotheses. Try carrying out similar proofs of these:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>hfa</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>hgb</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>nnf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>nng</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>hfa</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnUb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>hgb</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnUb</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>nng</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>nna</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>FnUb</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Even though we have defined <code>FnUb</code> and <code>FnLb</code> for functions from the reals to the reals, you should recognize that the definitions and proofs are much more general. The definitions make sense for functions between any two types for which there is a notion of order on the codomain. Checking the type of the theorem <code>add_le_add</code> shows that it holds of any structure that is an "ordered additive commutative monoid"; the details of what that means don't matter now, but it is worth knowing that the natural numbers, integers, rationals, and real numbers are all instances. So if we prove the theorem <code>fnUb_add</code> at that level of generality, it will apply in all these instances.</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>R</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>[</span><span class=n>OrderedCancelAddCommMonoid</span><span class=w> </span><span class=n>R</span><span class=o>]</span>

<span class=k>#check</span><span class=w> </span><span class=n>add_le_add</span>

<span class=kd>def</span><span class=w> </span><span class=n>FnUb&#39;</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>R</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>R</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>a</span>

<span class=kd>theorem</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=o>{</span><span class=n>f</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>R</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>R</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>hfa</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnUb&#39;</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>hgb</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnUb&#39;</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>FnUb&#39;</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>add_le_add</span><span class=w> </span><span class=o>(</span><span class=n>hfa</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>hgb</span><span class=w> </span><span class=n>x</span><span class=o>)</span>
</code></pre></div> <p>You have already seen square brackets like these in Section :numref:<code>proving_identities_in_algebraic_structures</code>, though we still haven't explained what they mean. For concreteness, we will stick to the real numbers for most of our examples, but it is worth knowing that Mathlib contains definitions and theorems that work at a high level of generality.</p> <p>For another example of a hidden universal quantifier, Mathlib defines a predicate <code>Monotone</code>, which says that a function is nondecreasing in its arguments:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=o>},</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>@</span><span class=n>h</span>
</code></pre></div> <p>The property <code>Monotone f</code> is defined to be exactly the expression after the colon. We need to put the <code>@</code> symbol before <code>h</code> because if we don't, Lean expands the implicit arguments to <code>h</code> and inserts placeholders.</p> <p>Proving statements about monotonicity involves using <code>intro</code> to introduce two variables, say, <code>a</code> and <code>b</code>, and the hypothesis <code>a ≤ b</code>. To <em>use</em> a monotonicity hypothesis, you can apply it to suitable arguments and hypotheses, and then apply the resulting expression to the goal. Or you can apply it to the goal and let Lean help you work backwards by displaying the remaining hypotheses as new subgoals.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>mf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>mg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>aleb</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>add_le_add</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>mf</span><span class=w> </span><span class=n>aleb</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>mg</span><span class=w> </span><span class=n>aleb</span>
</code></pre></div> <p>When a proof is this short, it is often convenient to give a proof term instead. To describe a proof that temporarily introduces objects <code>a</code> and <code>b</code> and a hypothesis <code>aleb</code>, Lean uses the notation <code>fun a b aleb ↦ ...</code>. This is analogous to the way that an expression like <code>fun x ↦ x^2</code> describes a function by temporarily naming an object, <code>x</code>, and then using it to describe a value. So the <code>intro</code> command in the previous proof corresponds to the lambda abstraction in the next proof term. The <code>apply</code> commands then correspond to building the application of the theorem to its arguments.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>mf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>mg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>fun</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>aleb</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>add_le_add</span><span class=w> </span><span class=o>(</span><span class=n>mf</span><span class=w> </span><span class=n>aleb</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>mg</span><span class=w> </span><span class=n>aleb</span><span class=o>)</span>
</code></pre></div> <p>Here is a useful trick: if you start writing the proof term <code>fun a b aleb ↦ _</code> using an underscore where the rest of the expression should go, Lean will flag an error, indicating that it can't guess the value of that expression. If you check the Lean Goal window in VS Code or hover over the squiggly error marker, Lean will show you the goal that the remaining expression has to solve.</p> <p>Try proving these, with either tactics or proof terms:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>c</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>mf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>nnc</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>c</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>mf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>mg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>(</span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Here are some more examples. A function :math:<code>f</code> from <span class=arithmatex>\(\mathbb{R}\)</span> to <span class=arithmatex>\(\mathbb{R}\)</span> is said to be <em>even</em> if <span class=arithmatex>\(f(-x) = f(x)\)</span> for every <span class=arithmatex>\(x\)</span>, and <em>odd</em> if <span class=arithmatex>\(f(-x) = -f(x)\)</span> for every <span class=arithmatex>\(x\)</span>. The following example defines these two notions formally and establishes one fact about them. You can complete the proofs of the others.</p> <div class=highlight><pre><span></span><code><span class=kd>def</span><span class=w> </span><span class=n>FnEven</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>(</span><span class=bp>-</span><span class=n>x</span><span class=o>)</span>

<span class=kd>def</span><span class=w> </span><span class=n>FnOdd</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=bp>-</span><span class=n>f</span><span class=w> </span><span class=o>(</span><span class=bp>-</span><span class=n>x</span><span class=o>)</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ef</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnEven</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>eg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnEven</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnEven</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>x</span>
<span class=w>  </span><span class=k>calc</span>
<span class=w>    </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>rfl</span>
<span class=w>    </span><span class=n>_</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>(</span><span class=bp>-</span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=o>(</span><span class=bp>-</span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>ef</span><span class=o>,</span><span class=w> </span><span class=n>eg</span><span class=o>]</span>


<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>of</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnOdd</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>og</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnOdd</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnEven</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ef</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnEven</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>og</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnOdd</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnOdd</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ef</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnEven</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>og</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnOdd</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnEven</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>(</span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>The first proof can be shortened using <code>dsimp</code> or <code>change</code> to get rid of the lambda abstraction. But you can check that the subsequent <code>rw</code> won't work unless we get rid of the lambda abstraction explicitly, because otherwise it cannot find the patterns <code>f x</code> and <code>g x</code> in the expression. Contrary to some other tactics, <code>rw</code> operates on the syntactic level, it won't unfold definitions or apply reductions for you (it has a variant called <code>erw</code> that tries a little harder in this direction, but not much harder).</p> <p>You can find implicit universal quantifiers all over the place, once you know how to spot them.</p> <p>Mathlib includes a good library for manipulating sets. Recall that Lean does not use foundations based on set theory, so here the word set has its mundane meaning of a collection of mathematical objects of some given type <code>α</code>. If <code>x</code> has type <code>α</code> and <code>s</code> has type <code>Set α</code>, then <code>x ∈ s</code> is a proposition that asserts that <code>x</code> is an element of <code>s</code>. If <code>y</code> has some different type <code>β</code> then the expression <code>y ∈ s</code> makes no sense. Here "makes no sense" means "has no type hence Lean does not accept it as a well-formed statement". This contrasts with Zermelo-Fraenkel set theory for instance where <code>a ∈ b</code> is a well-formed statement for every mathematical objects <code>a</code> and <code>b</code>. For instance <code>sin ∈ cos</code> is a well-formed statement in ZF. This defect of set theoretic foundations is an important motivation for not using it in a proof assistant which is meant to assist us by detecting meaningless expressions. In Lean <code>sin</code> has type <code>ℝ → ℝ</code> and <code>cos</code> has type <code>ℝ → ℝ</code> which is not equal to <code>Set (ℝ → ℝ)</code>, even after unfolding definitions, so the statement <code>sin ∈ cos</code> makes no sense. One can also use Lean to work on set theory itself. For instance the independence of the continuum hypothesis from the axioms of Zermelo-Fraenkel has been formalized in Lean. But such a meta-theory of set theory is completely beyond the scope of this book.</p> <p>If <code>s</code> and <code>t</code> are of type <code>Set α</code>, then the subset relation <code>s ⊆ t</code> is defined to mean <code>∀ {x : α}, x ∈ s → x ∈ t</code>. The variable in the quantifier is marked implicit so that given <code>h : s ⊆ t</code> and <code>h' : x ∈ s</code>, we can write <code>h h'</code> as justification for <code>x ∈ t</code>. The following example provides a tactic proof and a proof term justifying the reflexivity of the subset relation, and asks you to do the same for transitivity.</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>r</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Set</span><span class=w> </span><span class=n>α</span><span class=o>)</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=bp>⊆</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>xs</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>xs</span>

<span class=kd>theorem</span><span class=w> </span><span class=n>Subset.refl</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=bp>⊆</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>xs</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>xs</span>

<span class=kd>theorem</span><span class=w> </span><span class=n>Subset.trans</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=bp>⊆</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=bp>⊆</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=bp>⊆</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Just as we defined <code>FnUb</code> for functions, we can define <code>SetUb s a</code> to mean that <code>a</code> is an upper bound on the set <code>s</code>, assuming <code>s</code> is a set of elements of some type that has an order associated with it. In the next example, we ask you to prove that if <code>a</code> is a bound on <code>s</code> and <code>a ≤ b</code>, then <code>b</code> is a bound on <code>s</code> as well.</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>[</span><span class=n>PartialOrder</span><span class=w> </span><span class=n>α</span><span class=o>]</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>s</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Set</span><span class=w> </span><span class=n>α</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=o>)</span>

<span class=kd>def</span><span class=w> </span><span class=n>SetUb</span><span class=w> </span><span class=o>(</span><span class=n>s</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Set</span><span class=w> </span><span class=n>α</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∈</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>a</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>SetUb</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h&#39;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>SetUb</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>We close this section with one last important example. A function :math:<code>f</code> is said to be <em>injective</em> if for every :math:<code>x_1</code> and :math:<code>x_2</code>, if :math:<code>f(x_1) = f(x_2)</code> then :math:<code>x_1 = x_2</code>. Mathlib defines <code>Function.Injective f</code> with <code>x₁</code> and <code>x₂</code> implicit. The next example shows that, on the real numbers, any function that adds a constant is injective. We then ask you to show that multiplication by a nonzero constant is also injective, using the lemma name in the example as a source of inspiration. Recall you should use Ctrl-space completion after guessing the beginning of a lemma name.</p> <div class=highlight><pre><span></span><code><span class=kn>open</span><span class=w> </span><span class=n>Function</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>c</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Injective</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>x₁</span><span class=w> </span><span class=n>x₂</span><span class=w> </span><span class=n>h&#39;</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=o>(</span><span class=n>add_left_inj</span><span class=w> </span><span class=n>c</span><span class=o>)</span><span class=bp>.</span><span class=n>mp</span><span class=w> </span><span class=n>h&#39;</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>c</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Injective</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Finally, show that the composition of two injective functions is injective:</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>β</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>γ</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span>
<span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>g</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>β</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>γ</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>β</span><span class=o>}</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>injg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Injective</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>injf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Injective</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Injective</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <h2 id=the-existential-quantifier>The Existential Quantifier<a class=headerlink href=#the-existential-quantifier title="Permanent link">&para;</a></h2> <p>The existential quantifier, which can be entered as <code>\ex</code> in VS Code, is used to represent the phrase "there exists." The formal expression <code>∃ x : ℝ, 2 &lt; x ∧ x &lt; 3</code> in Lean says that there is a real number between 2 and 3. (We will discuss the conjunction symbol, <code>∧</code>, in :numref:<code>conjunction_and_biimplication</code>.) The canonical way to prove such a statement is to exhibit a real number and show that it has the stated property. The number 2.5, which we can enter as <code>5 / 2</code> or <code>(5 : ℝ) / 2</code> when Lean cannot infer from context that we have the real numbers in mind, has the required property, and the <code>norm_num</code> tactic can prove that it meets the description.</p> <p>There are a few ways we can put the information together. Given a goal that begins with an existential quantifier, the <code>use</code> tactic is used to provide the object, leaving the goal of proving the property.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span>
<span class=w>  </span><span class=n>norm_num</span>
</code></pre></div> <p>You can give the <code>use</code> tactic proofs as well as data:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h1</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=o>(</span><span class=mi>5</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>norm_num</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h2</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=o>(</span><span class=mi>5</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>norm_num</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=o>,</span><span class=w> </span><span class=n>h1</span><span class=o>,</span><span class=w> </span><span class=n>h2</span>
</code></pre></div> <p>In fact, the <code>use</code> tactic automatically tries to use available assumptions as well.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=o>(</span><span class=mi>5</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=o>(</span><span class=mi>5</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>norm_num</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span>
</code></pre></div> <p>Alternatively, we can use Lean's <em>anonymous constructor</em> notation to construct a proof of an existential quantifier.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=o>(</span><span class=mi>5</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=o>(</span><span class=mi>5</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>norm_num</span>
<span class=w>  </span><span class=o>⟨</span><span class=mi>5</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=o>,</span><span class=w> </span><span class=n>h</span><span class=o>⟩</span>
</code></pre></div> <p>Notice that there is no <code>by</code>; here we are giving an explicit proof term. The left and right angle brackets, which can be entered as <code>\&lt;</code> and <code>\&gt;</code> respectively, tell Lean to put together the given data using whatever construction is appropriate for the current goal. We can use the notation without going first into tactic mode:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=o>⟨</span><span class=mi>5</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=o>,</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>norm_num</span><span class=o>⟩</span>
</code></pre></div> <p>So now we know how to <em>prove</em> an exists statement. But how do we <em>use</em> one? If we know that there exists an object with a certain property, we should be able to give a name to an arbitrary one and reason about it. For example, remember the predicates <code>FnUb f a</code> and <code>FnLb f a</code> from the last section, which say that <code>a</code> is an upper bound or lower bound on <code>f</code>, respectively. We can use the existential quantifier to say that "<code>f</code> is bounded" without specifying the bound:</p> <div class=highlight><pre><span></span><code><span class=kd>def</span><span class=w> </span><span class=n>FnUb</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>a</span>

<span class=kd>def</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span>

<span class=kd>def</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∃</span><span class=w> </span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>FnUb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span>

<span class=kd>def</span><span class=w> </span><span class=n>FnHasLb</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∃</span><span class=w> </span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>FnLb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span>
</code></pre></div> <p>We can use the theorem <code>FnUb_add</code> from the last section to prove that if <code>f</code> and <code>g</code> have upper bounds, then so does <code>fun x ↦ f x + g x</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>f</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ubf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ubg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>ubf</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>ubfa</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>ubg</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=n>ubgb</span>
</code></pre></div> <p>The <code>rcases</code> tactic unpacks the information in the existential quantifier. The annotations like <code>⟨a, ubfa⟩</code>, written with the same angle brackets as the anonymous constructors, are known as <em>patterns</em>, and they describe the information that we expect to find when we unpack the main argument. Given the hypothesis <code>ubf</code> that there is an upper bound for <code>f</code>, <code>rcases ubf with ⟨a, ubfa⟩</code> adds a new variable <code>a</code> for an upper bound to the context, together with the hypothesis <code>ubfa</code> that it has the given property. The goal is left unchanged; what <em>has</em> changed is that we can now use the new object and the new hypothesis to prove the goal. This is a common method of reasoning in mathematics: we unpack objects whose existence is asserted or implied by some hypothesis, and then use it to establish the existence of something else.</p> <p>Try using this method to establish the following. You might find it useful to turn some of the examples from the last section into named theorems, as we did with <code>fn_ub_add</code>, or you can insert the arguments directly into the proofs.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>lbf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasLb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>lbg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasLb</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasLb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>c</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>ubf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>≥</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>The "r" in <code>rcases</code> stands for "recursive," because it allows us to use arbitrarily complex patterns to unpack nested data. The <code>rintro</code> tactic is a combination of <code>intro</code> and <code>rcases</code>:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rintro</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>ubfa</span><span class=o>⟩</span><span class=w> </span><span class=o>⟨</span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>
</code></pre></div> <p>In fact, Lean also supports a pattern-matching fun in expressions and proof terms:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>fun</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>ubfa</span><span class=o>⟩</span><span class=w> </span><span class=o>⟨</span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>
</code></pre></div> <p>The task of unpacking information in a hypothesis is so important that Lean and Mathlib provide a number of ways to do it. For example, the <code>obtain</code> tactic provides suggestive syntax:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ubf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ubg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>obtain</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>ubfa</span><span class=o>⟩</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>ubf</span>
<span class=w>  </span><span class=n>obtain</span><span class=w> </span><span class=o>⟨</span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>ubg</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>
</code></pre></div> <p>Think of the first <code>obtain</code> instruction as matching the "contents" of <code>ubf</code> with the given pattern and assigning the components to the named variables. <code>rcases</code> and <code>obtain</code> are said to <code>destruct</code> their arguments, though there is a small difference in that <code>rcases</code> clears <code>ubf</code> from the context when it is done, whereas it is still present after <code>obtain</code>.</p> <p>Lean also supports syntax that is similar to that used in other functional programming languages:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ubf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ubg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>cases</span><span class=w> </span><span class=n>ubf</span>
<span class=w>  </span><span class=n>case</span><span class=w> </span><span class=n>intro</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>    </span><span class=n>cases</span><span class=w> </span><span class=n>ubg</span>
<span class=w>    </span><span class=n>case</span><span class=w> </span><span class=n>intro</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>ubgb</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>      </span><span class=n>exact</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ubf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ubg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>cases</span><span class=w> </span><span class=n>ubf</span>
<span class=w>  </span><span class=n>next</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>    </span><span class=n>cases</span><span class=w> </span><span class=n>ubg</span>
<span class=w>    </span><span class=n>next</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>ubgb</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>      </span><span class=n>exact</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ubf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ubg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=k>match</span><span class=w> </span><span class=n>ubf</span><span class=o>,</span><span class=w> </span><span class=n>ubg</span><span class=w> </span><span class=k>with</span>
<span class=w>    </span><span class=bp>|</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>ubfa</span><span class=o>⟩,</span><span class=w> </span><span class=o>⟨</span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>      </span><span class=n>exact</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>ubf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ubg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>match</span><span class=w> </span><span class=n>ubf</span><span class=o>,</span><span class=w> </span><span class=n>ubg</span><span class=w> </span><span class=k>with</span>
<span class=w>    </span><span class=bp>|</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>ubfa</span><span class=o>⟩,</span><span class=w> </span><span class=o>⟨</span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>      </span><span class=o>⟨</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>fnUb_add</span><span class=w> </span><span class=n>ubfa</span><span class=w> </span><span class=n>ubgb</span><span class=o>⟩</span>
</code></pre></div> <p>In the first example, if you put your cursor after <code>cases ubf</code>, you will see that the tactic produces a single goal, which Lean has tagged <code>intro</code>. (The particular name chosen comes from the internal name for the axiomatic primitive that builds a proof of an existential statement.) The <code>case</code> tactic then names the components. The second example is similar, except using <code>next</code> instead of <code>case</code> means that you can avoid mentioning <code>intro</code>. The word <code>match</code> in the last two examples highlights that what we are doing here is what computer scientists call "pattern matching." Notice that the third proof begins by <code>by</code>, after which the tactic version of <code>match</code> expects a tactic proof on the right side of the arrow. The last example is a proof term: there are no tactics in sight.</p> <p>For the rest of this book, we will stick to <code>rcases</code>, <code>rintro</code>, and <code>obtain</code>, as the preferred ways of using an existential quantifier. But it can't hurt to see the alternative syntax, especially if there is a chance you will find yourself in the company of computer scientists.</p> <p>To illustrate one way that <code>rcases</code> can be used, we prove an old mathematical chestnut: if two integers <code>x</code> and <code>y</code> can each be written as a sum of two squares, then so can their product, <code>x * y</code>. In fact, the statement is true for any commutative ring, not just the integers. In the next example, <code>rcases</code> unpacks two existential quantifiers at once. We then provide the magic values needed to express <code>x * y</code> as a sum of squares as a list to the <code>use</code> statement, and we use <code>ring</code> to verify that they work.</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>[</span><span class=n>CommRing</span><span class=w> </span><span class=n>α</span><span class=o>]</span>

<span class=kd>def</span><span class=w> </span><span class=n>SumOfSquares</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∃</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span>

<span class=kd>theorem</span><span class=w> </span><span class=n>sumOfSquares_mul</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>sosx</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>SumOfSquares</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>sosy</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>SumOfSquares</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>SumOfSquares</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>sosx</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>xeq</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>sosy</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>c</span><span class=o>,</span><span class=w> </span><span class=n>d</span><span class=o>,</span><span class=w> </span><span class=n>yeq</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>xeq</span><span class=o>,</span><span class=w> </span><span class=n>yeq</span><span class=o>]</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>d</span><span class=o>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>c</span>
<span class=w>  </span><span class=n>ring</span>
</code></pre></div> <p>This proof doesn't provide much insight, but here is one way to motivate it. A <em>Gaussian integer</em> is a number of the form <span class=arithmatex>\(a + bi\)</span> where <span class=arithmatex>\(a\)</span> and <span class=arithmatex>\(b\)</span> are integers and <span class=arithmatex>\(i = \sqrt{-1}\)</span>. The <em>norm</em> of the Gaussian integer <span class=arithmatex>\(a + bi\)</span> is, by definition, <span class=arithmatex>\(a^2 + b^2\)</span>. So the norm of a Gaussian integer is a sum of squares, and any sum of squares can be expressed in this way. The theorem above reflects the fact that norm of a product of Gaussian integers is the product of their norms: if <span class=arithmatex>\(x\)</span> is the norm of <span class=arithmatex>\(a + bi\)</span> and <span class=arithmatex>\(y\)</span> in the norm of <span class=arithmatex>\(c + di\)</span>, then <span class=arithmatex>\(xy\)</span> is the norm of <span class=arithmatex>\((a + bi) (c + di)\)</span>. Our cryptic proof illustrates the fact that the proof that is easiest to formalize isn't always the most perspicuous one. In :numref:<code>section_building_the_gaussian_integers</code>, we will provide you with the means to define the Gaussian integers and use them to provide an alternative proof.</p> <p>The pattern of unpacking an equation inside an existential quantifier and then using it to rewrite an expression in the goal comes up often, so much so that the <code>rcases</code> tactic provides an abbreviation: if you use the keyword <code>rfl</code> in place of a new identifier, <code>rcases</code> does the rewriting automatically (this trick doesn't work with pattern-matching lambdas).</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>sumOfSquares_mul&#39;</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>sosx</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>SumOfSquares</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>sosy</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>SumOfSquares</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>SumOfSquares</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>sosx</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>rfl</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>sosy</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>c</span><span class=o>,</span><span class=w> </span><span class=n>d</span><span class=o>,</span><span class=w> </span><span class=n>rfl</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>d</span><span class=o>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>c</span>
<span class=w>  </span><span class=n>ring</span>
</code></pre></div> <p>As with the universal quantifier, you can find existential quantifiers hidden all over if you know how to spot them. For example, divisibility is implicitly an "exists" statement.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>divab</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>divbc</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>c</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>divab</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>d</span><span class=o>,</span><span class=w> </span><span class=n>beq</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>divbc</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>e</span><span class=o>,</span><span class=w> </span><span class=n>ceq</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>ceq</span><span class=o>,</span><span class=w> </span><span class=n>beq</span><span class=o>]</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>e</span><span class=bp>;</span><span class=w> </span><span class=n>ring</span>
</code></pre></div> <p>And once again, this provides a nice setting for using <code>rcases</code> with <code>rfl</code>. Try it out in the proof above. It feels pretty good!</p> <p>Then try proving the following:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>divab</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>divac</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>c</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>For another important example, a function <span class=arithmatex>\(f : \alpha \to \beta\)</span> is said to be <em>surjective</em> if for every <span class=arithmatex>\(y\)</span> in the codomain, <span class=arithmatex>\(\beta\)</span>, there is an <span class=arithmatex>\(x\)</span> in the domain, <span class=arithmatex>\(\alpha\)</span>, such that $f(x) = $<code>. Notice that this statement includes both a universal and an existential quantifier, which explains why the next example makes use of both</code>intro<code>and</code>use`.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>c</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Surjective</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>x</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>c</span>
<span class=w>  </span><span class=n>dsimp</span><span class=bp>;</span><span class=w> </span><span class=n>ring</span>
</code></pre></div> <p>Try this example yourself using the theorem <code>mul_div_cancel₀</code>.:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>c</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Surjective</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>At this point, it is worth mentioning that there is a tactic, <code>field_simp</code>, that will often clear denominators in a useful way. It can be used in conjunction with the <code>ring</code> tactic.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=o>)</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>field_simp</span><span class=w> </span><span class=o>[</span><span class=n>h</span><span class=o>]</span>
<span class=w>  </span><span class=n>ring</span>
</code></pre></div> <p>The next example uses a surjectivity hypothesis by applying it to a suitable value. Note that you can use <code>rcases</code> with any expression, not just a hypothesis.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Surjective</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>hx</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>x</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>hx</span><span class=o>]</span>
<span class=w>  </span><span class=n>norm_num</span>
</code></pre></div> <p>See if you can use these methods to show that the composition of surjective functions is surjective.</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>β</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>γ</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span>
<span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>g</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>β</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>γ</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>β</span><span class=o>}</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>surjg</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Surjective</span><span class=w> </span><span class=n>g</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>surjf</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Surjective</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Surjective</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=o>(</span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <h2 id=negation>Negation<a class=headerlink href=#negation title="Permanent link">&para;</a></h2> <p>The symbol <code>¬</code> is meant to express negation, so <code>¬ x &lt; y</code> says that <code>x</code> is not less than <code>y</code>, <code>¬ x = y</code> (or, equivalently, <code>x ≠ y</code>) says that <code>x</code> is not equal to <code>y</code>, and <code>¬ ∃ z, x &lt; z ∧ z &lt; y</code> says that there does not exist a <code>z</code> strictly between <code>x</code> and <code>y</code>. In Lean, the notation <code>¬ A</code> abbreviates <code>A → False</code>, which you can think of as saying that <code>A</code> implies a contradiction. Practically speaking, this means that you already know something about how to work with negations: you can prove <code>¬ A</code> by introducing a hypothesis <code>h : A</code> and proving <code>False</code>, and if you have <code>h : ¬ A</code> and <code>h' : A</code>, then applying <code>h</code> to <code>h'</code> yields <code>False</code>.</p> <p>To illustrate, consider the irreflexivity principle <code>lt_irrefl</code> for a strict order, which says that we have <code>¬ a &lt; a</code> for every <code>a</code>. The asymmetry principle <code>lt_asymm</code> says that we have <code>a &lt; b → ¬ b &lt; a</code>. Let's show that <code>lt_asymm</code> follows from <code>lt_irrefl</code>. section</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>b</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>h&#39;</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>lt_trans</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=n>h&#39;</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>lt_irrefl</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>this</span>
</code></pre></div> <p>This example introduces a couple of new tricks. First, when you use <code>have</code> without providing a label, Lean uses the name <code>this</code>, providing a convenient way to refer back to it. Because the proof is so short, we provide an explicit proof term. But what you should really be paying attention to in this proof is the result of the <code>intro</code> tactic, which leaves a goal of <code>False</code>, and the fact that we eventually prove <code>False</code> by applying <code>lt_irrefl</code> to a proof of <code>a &lt; a</code>.</p> <p>Here is another example, which uses the predicate <code>FnHasUb</code> defined in the last section, which says that a function has an upper bound.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>fnub</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>fnub</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>fnuba</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>hx</span><span class=o>⟩</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>fnuba</span><span class=w> </span><span class=n>x</span>
<span class=w>  </span><span class=n>linarith</span>
</code></pre></div> <p>Remember that it is often convenient to use <code>linarith</code> when a goal follows from linear equations and inequalities that are in the context.</p> <p>See if you can prove these in a similar way:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>FnHasLb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>FnHasUb</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Mathlib offers a number of useful theorems for relating orders and negations:</p> <div class=highlight><pre><span></span><code><span class=k>#check</span><span class=w> </span><span class=o>(</span><span class=n>not_le_of_gt</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>¬</span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>b</span><span class=o>)</span>
<span class=k>#check</span><span class=w> </span><span class=o>(</span><span class=n>not_lt_of_ge</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≥</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>¬</span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>b</span><span class=o>)</span>
<span class=k>#check</span><span class=w> </span><span class=o>(</span><span class=n>lt_of_not_ge</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>a</span><span class=w> </span><span class=bp>≥</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>b</span><span class=o>)</span>
<span class=k>#check</span><span class=w> </span><span class=o>(</span><span class=n>le_of_not_gt</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>a</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>b</span><span class=o>)</span>
</code></pre></div> <p>Recall the predicate <code>Monotone f</code>, which says that <code>f</code> is nondecreasing. Use some of the theorems just enumerated to prove the following:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h&#39;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h&#39;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>We can show that the first example in the last snippet cannot be proved if we replace <code>&lt;</code> by <code>≤</code>. Notice that we can prove the negation of a universally quantified statement by giving a counterexample. Complete the proof.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬∀</span><span class=w> </span><span class=o>{</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>},</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=o>},</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=k>let</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=o>(</span><span class=mi>0</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>monof</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h&#39;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>le_refl</span><span class=w> </span><span class=n>_</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>This example introduces the <code>let</code> tactic, which adds a <em>local definition</em> to the context. If you put the cursor after the <code>let</code> command, in the goal window you will see that the definition <code>f : ℝ → ℝ := fun x ↦ 0</code> has been added to the context. Lean will unfold the definition of <code>f</code> when it has to. In particular, when we prove <code>f 1 ≤ f 0</code> with <code>le_refl</code>, Lean reduces <code>f 1</code> and <code>f 0</code> to <code>0</code>.</p> <p>Use <code>le_of_not_gt</code> to prove the following:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=o>,</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Implicit in many of the proofs we have just done is the fact that if <code>P</code> is any property, saying that there is nothing with property <code>P</code> is the same as saying that everything fails to have property <code>P</code>, and saying that not everything has property <code>P</code> is equivalent to saying that something fails to have property <code>P</code>. In other words, all four of the following implications are valid (but one of them cannot be proved with what we explained so far):</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>P</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=kt>Prop</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>Q</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=o>)</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=bp>¬</span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=bp>¬</span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=bp>¬</span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=bp>¬</span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>The first, second, and fourth are straightforward to prove using the methods you have already seen. We encourage you to try it. The third is more difficult, however, because it concludes that an object exists from the fact that its nonexistence is contradictory. This is an instance of <em>classical</em> mathematical reasoning. We can use proof by contradiction to prove the third implication as follows.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬∀</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=bp>¬</span><span class=n>P</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>by_contra</span><span class=w> </span><span class=n>h&#39;</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>x</span>
<span class=w>  </span><span class=k>show</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=n>x</span>
<span class=w>  </span><span class=n>by_contra</span><span class=w> </span><span class=n>h&#39;&#39;</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>h&#39;</span><span class=w> </span><span class=o>⟨</span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>h&#39;&#39;</span><span class=o>⟩</span>
</code></pre></div> <p>Make sure you understand how this works. The <code>by_contra</code> tactic allows us to prove a goal <code>Q</code> by assuming <code>¬ Q</code> and deriving a contradiction. In fact, it is equivalent to using the equivalence <code>not_not : ¬ ¬ Q ↔ Q</code>. Confirm that you can prove the forward direction of this equivalence using <code>by_contra</code>, while the reverse direction follows from the ordinary rules for negation.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬¬</span><span class=n>Q</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Q</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>Q</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬¬</span><span class=n>Q</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Use proof by contradiction to establish the following, which is the converse of one of the implications we proved above. (Hint: use <code>intro</code> first.)</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>It is often tedious to work with compound statements with a negation in front, and it is a common mathematical pattern to replace such statements with equivalent forms in which the negation has been pushed inward. To facilitate this, Mathlib offers a <code>push_neg</code> tactic, which restates the goal in this way. The command <code>push_neg at h</code> restates the hypothesis <code>h</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬∀</span><span class=w> </span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>push_neg</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>dsimp</span><span class=w> </span><span class=n>only</span><span class=w> </span><span class=o>[</span><span class=n>FnHasUb</span><span class=o>,</span><span class=w> </span><span class=n>FnUb</span><span class=o>]</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>push_neg</span><span class=w> </span><span class=n>at</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>
</code></pre></div> <p>In the second example, we use dsimp to expand the definitions of <code>FnHasUb</code> and <code>FnUb</code>. (We need to use <code>dsimp</code> rather than <code>rw</code> to expand <code>FnUb</code>, because it appears in the scope of a quantifier.) You can verify that in the examples above with <code>¬∃ x, P x</code> and <code>¬∀ x, P x</code>, the <code>push_neg</code> tactic does the expected thing. Without even knowing how to use the conjunction symbol, you should be able to use <code>push_neg</code> to prove the following:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=o>,</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Mathlib also has a tactic, <code>contrapose</code>, which transforms a goal <code>A → B</code> to <code>¬B → ¬A</code>. Similarly, given a goal of proving <code>B</code> from hypothesis <code>h : A</code>, <code>contrapose h</code> leaves you with a goal of proving <code>¬A</code> from hypothesis <code>¬B</code>. Using <code>contrapose!</code> instead of <code>contrapose</code> applies <code>push_neg</code> to the goal and the relevant hypothesis as well.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>FnHasUb</span><span class=w> </span><span class=n>f</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=o>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>contrapose</span><span class=bp>!</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=o>,</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>ε</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>contrapose</span><span class=bp>!</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span>
<span class=w>  </span><span class=n>constructor</span><span class=w> </span><span class=bp>&lt;;&gt;</span><span class=w> </span><span class=n>linarith</span>
</code></pre></div> <p>We have not yet explained the <code>constructor</code> command or the use of the semicolon after it, but we will do that in the next section.</p> <p>We close this section with the principle of <em>ex falso</em>, which says that anything follows from a contradiction. In Lean, this is represented by <code>False.elim</code>, which establishes <code>False → P</code> for any proposition <code>P</code>. This may seem like a strange principle, but it comes up fairly often. We often prove a theorem by splitting on cases, and sometimes we can show that one of the cases is contradictory. In that case, we need to assert that the contradiction establishes the goal so we can move on to the next one. (We will see instances of reasoning by cases in :numref:<code>disjunction</code>.)</p> <p>Lean provides a number of ways of closing a goal once a contradiction has been reached.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>37</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>exfalso</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>lt_irrefl</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>h</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>37</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=n>absurd</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>(</span><span class=n>lt_irrefl</span><span class=w> </span><span class=mi>0</span><span class=o>)</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>37</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h&#39;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>lt_irrefl</span><span class=w> </span><span class=mi>0</span>
<span class=w>  </span><span class=n>contradiction</span>
</code></pre></div> <p>The <code>exfalso</code> tactic replaces the current goal with the goal of proving <code>False</code>. Given <code>h : P</code> and <code>h' : ¬ P</code>, the term <code>absurd h h'</code> establishes any proposition. Finally, the <code>contradiction</code> tactic tries to close a goal by finding a contradiction in the hypotheses, such as a pair of the form <code>h : P</code> and <code>h' : ¬ P</code>. Of course, in this example, <code>linarith</code> also works.</p> <h2 id=conjunction-and-iff>Conjunction and Iff<a class=headerlink href=#conjunction-and-iff title="Permanent link">&para;</a></h2> <p>You have already seen that the conjunction symbol, <code>∧</code>, is used to express "and." The <code>constructor</code> tactic allows you to prove a statement of the form <code>A ∧ B</code> by proving <code>A</code> and then proving <code>B</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h₀</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h₁</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>constructor</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>assumption</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>h₁</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>h</span><span class=o>]</span>
</code></pre></div> <p>In this example, the <code>assumption</code> tactic tells Lean to find an assumption that will solve the goal. Notice that the final <code>rw</code> finishes the goal by applying the reflexivity of <code>≤</code>. The following are alternative ways of carrying out the previous examples using the anonymous constructor angle brackets. The first is a slick proof-term version of the previous proof, which drops into tactic mode at the keyword <code>by</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h₀</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h₁</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=o>⟨</span><span class=n>h₀</span><span class=o>,</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=o>(</span><span class=kd>by</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>h</span><span class=o>])⟩</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h₀</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h₁</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>    </span><span class=n>contrapose</span><span class=bp>!</span><span class=w> </span><span class=n>h₁</span>
<span class=w>    </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>h₁</span><span class=o>]</span>
<span class=w>  </span><span class=o>⟨</span><span class=n>h₀</span><span class=o>,</span><span class=w> </span><span class=n>h</span><span class=o>⟩</span>
</code></pre></div> <p><em>Using</em> a conjunction instead of proving one involves unpacking the proofs of the two parts. You can use the <code>rcases</code> tactic for that, as well as <code>rintro</code> or a pattern-matching <code>fun</code>, all in a manner similar to the way they are used with the existential quantifier.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>h₀</span><span class=o>,</span><span class=w> </span><span class=n>h₁</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>contrapose</span><span class=bp>!</span><span class=w> </span><span class=n>h₁</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rintro</span><span class=w> </span><span class=o>⟨</span><span class=n>h₀</span><span class=o>,</span><span class=w> </span><span class=n>h₁</span><span class=o>⟩</span><span class=w> </span><span class=n>h&#39;</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=o>(</span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h&#39;</span><span class=o>)</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>fun</span><span class=w> </span><span class=o>⟨</span><span class=n>h₀</span><span class=o>,</span><span class=w> </span><span class=n>h₁</span><span class=o>⟩</span><span class=w> </span><span class=n>h&#39;</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=o>(</span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h&#39;</span><span class=o>)</span>
</code></pre></div> <p>In analogy to the <code>obtain</code> tactic, there is also a pattern-matching <code>have</code>:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=o>⟨</span><span class=n>h₀</span><span class=o>,</span><span class=w> </span><span class=n>h₁</span><span class=o>⟩</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>contrapose</span><span class=bp>!</span><span class=w> </span><span class=n>h₁</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span>
</code></pre></div> <p>In contrast to <code>rcases</code>, here the <code>have</code> tactic leaves <code>h</code> in the context. And even though we won't use them, once again we have the computer scientists' pattern-matching syntax:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>cases</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>case</span><span class=w> </span><span class=n>intro</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>    </span><span class=n>contrapose</span><span class=bp>!</span><span class=w> </span><span class=n>h₁</span>
<span class=w>    </span><span class=n>exact</span><span class=w> </span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>cases</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>next</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>    </span><span class=n>contrapose</span><span class=bp>!</span><span class=w> </span><span class=n>h₁</span>
<span class=w>    </span><span class=n>exact</span><span class=w> </span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=k>match</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=k>with</span>
<span class=w>    </span><span class=bp>|</span><span class=w> </span><span class=o>⟨</span><span class=n>h₀</span><span class=o>,</span><span class=w> </span><span class=n>h₁</span><span class=o>⟩</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>        </span><span class=n>contrapose</span><span class=bp>!</span><span class=w> </span><span class=n>h₁</span>
<span class=w>        </span><span class=n>exact</span><span class=w> </span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span>
</code></pre></div> <p>In contrast to using an existential quantifier, you can also extract proofs of the two components of a hypothesis <code>h : A ∧ B</code> by writing <code>h.left</code> and <code>h.right</code>, or, equivalently, <code>h.1</code> and <code>h.2</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>h&#39;</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>h.right</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h.left</span><span class=w> </span><span class=n>h&#39;</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>fun</span><span class=w> </span><span class=n>h&#39;</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>h.right</span><span class=w> </span><span class=o>(</span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h.left</span><span class=w> </span><span class=n>h&#39;</span><span class=o>)</span>
</code></pre></div> <p>Try using these techniques to come up with various ways of proving of the following:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>m</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>n</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=bp>¬</span><span class=n>n</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>You can nest uses of <code>∃</code> and <code>∧</code> with anonymous constructors, <code>rintro</code>, and <code>rcases</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=o>⟨</span><span class=mi>5</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=o>,</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>norm_num</span><span class=o>,</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>norm_num</span><span class=o>⟩</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=o>(</span><span class=bp>∃</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rintro</span><span class=w> </span><span class=o>⟨</span><span class=n>z</span><span class=o>,</span><span class=w> </span><span class=n>xltz</span><span class=o>,</span><span class=w> </span><span class=n>zlty</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>lt_trans</span><span class=w> </span><span class=n>xltz</span><span class=w> </span><span class=n>zlty</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=o>(</span><span class=bp>∃</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>fun</span><span class=w> </span><span class=o>⟨</span><span class=n>z</span><span class=o>,</span><span class=w> </span><span class=n>xltz</span><span class=o>,</span><span class=w> </span><span class=n>zlty</span><span class=o>⟩</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>lt_trans</span><span class=w> </span><span class=n>xltz</span><span class=w> </span><span class=n>zlty</span>
</code></pre></div> <p>You can also use the <code>use</code> tactic:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>,</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span>
<span class=w>  </span><span class=n>constructor</span><span class=w> </span><span class=bp>&lt;;&gt;</span><span class=w> </span><span class=n>norm_num</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=o>,</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>10</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>Nat.Prime</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>Nat.Prime</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=mi>5</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=mi>7</span>
<span class=w>  </span><span class=n>norm_num</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rintro</span><span class=w> </span><span class=o>⟨</span><span class=n>h₀</span><span class=o>,</span><span class=w> </span><span class=n>h₁</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>h₀</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>h&#39;</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=o>(</span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h&#39;</span><span class=o>)</span>
</code></pre></div> <p>In the first example, the semicolon after the <code>constructor</code> command tells Lean to use the <code>norm_num</code> tactic on both of the goals that result.</p> <p>In Lean, <code>A ↔ B</code> is <em>not</em> defined to be <code>(A → B) ∧ (B → A)</code>, but it could have been, and it behaves roughly the same way. You have already seen that you can write <code>h.mp</code> and <code>h.mpr</code> or <code>h.1</code> and <code>h.2</code> for the two directions of <code>h : A ↔ B</code>. You can also use <code>cases</code> and friends. To prove an if-and-only-if statement, you can use <code>constructor</code> or angle brackets, just as you would if you were proving a conjunction.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>constructor</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>contrapose</span><span class=bp>!</span>
<span class=w>    </span><span class=n>rintro</span><span class=w> </span><span class=n>rfl</span>
<span class=w>    </span><span class=n>rfl</span>
<span class=w>  </span><span class=n>contrapose</span><span class=bp>!</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=o>⟨</span><span class=k>fun</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=o>(</span><span class=kd>by</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>h₁</span><span class=o>]),</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>h₀</span><span class=w> </span><span class=o>(</span><span class=n>le_antisymm</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=n>h₁</span><span class=o>)⟩</span>
</code></pre></div> <p>The last proof term is inscrutable. Remember that you can use underscores while writing an expression like that to see what Lean expects.</p> <p>Try out the various techniques and gadgets you have just seen in order to prove the following:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=bp>¬</span><span class=n>y</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>For a more interesting exercise, show that for any two real numbers <code>x</code> and <code>y</code>, <code>x^2 + y^2 = 0</code> if and only if <code>x = 0</code> and <code>y = 0</code>. We suggest proving an auxiliary lemma using <code>linarith</code>, <code>pow_two_nonneg</code>, and <code>pow_eq_zero</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>aux</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h&#39;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>  </span><span class=n>pow_eq_zero</span><span class=w> </span><span class=n>h&#39;</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>In Lean, bi-implication leads a double-life. You can treat it like a conjunction and use its two parts separately. But Lean also knows that it is a reflexive, symmetric, and transitive relation between propositions, and you can also use it with <code>calc</code> and <code>rw</code>. It is often convenient to rewrite a statement to an equivalent one. In the next example, we use <code>abs_lt</code> to replace an expression of the form <code>|x| &lt; y</code> by the equivalent expression <code>- y &lt; x ∧ x &lt; y</code>, and in the one after that we use <code>Nat.dvd_gcd_iff</code> to replace an expression of the form <code>m ∣ Nat.gcd n k</code> by the equivalent expression <code>m ∣ n ∧ m ∣ k</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=mi>3</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>-</span><span class=mi>8</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_lt</span><span class=o>]</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>constructor</span><span class=w> </span><span class=bp>&lt;;&gt;</span><span class=w> </span><span class=n>linarith</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>Nat.gcd</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=mi>15</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>Nat.dvd_gcd_iff</span><span class=o>]</span>
<span class=w>  </span><span class=n>constructor</span><span class=w> </span><span class=bp>&lt;;&gt;</span><span class=w> </span><span class=n>norm_num</span>
</code></pre></div> <p>See if you can use <code>rw</code> with the theorem below to provide a short proof that negation is not a nondecreasing function. (Note that <code>push_neg</code> won't unfold definitions for you, so the <code>rw [Monotone]</code> in the proof of the theorem is needed.)</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>not_monotone_iff</span><span class=w> </span><span class=o>{</span><span class=n>f</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>Monotone</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=o>,</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>Monotone</span><span class=o>]</span>
<span class=w>  </span><span class=n>push_neg</span>
<span class=w>  </span><span class=n>rfl</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>Monotone</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=bp>-</span><span class=n>x</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>The remaining exercises in this section are designed to give you some more practice with conjunction and bi-implication. Remember that a <em>partial order</em> is a binary relation that is transitive, reflexive, and antisymmetric. An even weaker notion sometimes arises: a <em>preorder</em> is just a reflexive, transitive relation. For any pre-order <code>≤</code>, Lean axiomatizes the associated strict pre-order by <code>a &lt; b ↔ a ≤ b ∧ ¬ b ≤ a</code>. Show that if <code>≤</code> is a partial order, then <code>a &lt; b</code> is equivalent to <code>a ≤ b ∧ a ≠ b</code>:</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>[</span><span class=n>PartialOrder</span><span class=w> </span><span class=n>α</span><span class=o>]</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=o>)</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>lt_iff_le_not_le</span><span class=o>]</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Beyond logical operations, you do not need anything more than <code>le_refl</code> and <code>le_trans</code>. Show that even in the case where <code>≤</code> is only assumed to be a preorder, we can prove that the strict order is irreflexive and transitive. In the second example, for convenience, we use the simplifier rather than <code>rw</code> to express <code>&lt;</code> in terms of <code>≤</code> and <code>¬</code>. We will come back to the simplifier later, but here we are only relying on the fact that it will use the indicated lemma repeatedly, even if it needs to be instantiated to different values.</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>[</span><span class=n>Preorder</span><span class=w> </span><span class=n>α</span><span class=o>]</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=o>)</span>

<span class=c1>-- EXAMPLES:</span>
<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬</span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>lt_iff_le_not_le</span><span class=o>]</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>simp</span><span class=w> </span><span class=n>only</span><span class=w> </span><span class=o>[</span><span class=n>lt_iff_le_not_le</span><span class=o>]</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <h2 id=disjunction>Disjunction<a class=headerlink href=#disjunction title="Permanent link">&para;</a></h2> <p>The canonical way to prove a disjunction <code>A ∨ B</code> is to prove <code>A</code> or to prove <code>B</code>. The <code>left</code> tactic chooses <code>A</code>, and the <code>right</code> tactic chooses <code>B</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=mi>1</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>left</span>
<span class=w>  </span><span class=n>linarith</span><span class=w> </span><span class=o>[</span><span class=n>pow_two_nonneg</span><span class=w> </span><span class=n>x</span><span class=o>]</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=mi>1</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=mi>1</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>right</span>
<span class=w>  </span><span class=n>linarith</span><span class=w> </span><span class=o>[</span><span class=n>pow_two_nonneg</span><span class=w> </span><span class=n>x</span><span class=o>]</span>
</code></pre></div> <p>We cannot use an anonymous constructor to construct a proof of an "or" because Lean would have to guess which disjunct we are trying to prove. When we write proof terms we can use <code>Or.inl</code> and <code>Or.inr</code> instead to make the choice explicitly. Here, <code>inl</code> is short for "introduction left" and <code>inr</code> is short for "introduction right."</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=mi>1</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=n>Or.inl</span><span class=w> </span><span class=n>h</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=mi>1</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=mi>1</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=n>Or.inr</span><span class=w> </span><span class=n>h</span>
</code></pre></div> <p>It may seem strange to prove a disjunction by proving one side or the other. In practice, which case holds usually depends on a case distinction that is implicit or explicit in the assumptions and the data. The <code>rcases</code> tactic allows us to make use of a hypothesis of the form <code>A ∨ B</code>. In contrast to the use of <code>rcases</code> with conjunction or an existential quantifier, here the <code>rcases</code> tactic produces <em>two</em> goals. Both have the same conclusion, but in the first case, <code>A</code> is assumed to be true, and in the second case, <code>B</code> is assumed to be true. In other words, as the name suggests, the <code>rcases</code> tactic carries out a proof by cases. As usual, we can tell Lean what names to use for the hypotheses. In the next example, we tell Lean to use the name <code>h</code> on each branch.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>le_or_gt</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_of_nonneg</span><span class=w> </span><span class=n>h</span><span class=o>]</span>
<span class=w>    </span><span class=n>intro</span><span class=w> </span><span class=n>h</span><span class=bp>;</span><span class=w> </span><span class=n>left</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=bp>.</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_of_neg</span><span class=w> </span><span class=n>h</span><span class=o>]</span>
<span class=w>    </span><span class=n>intro</span><span class=w> </span><span class=n>h</span><span class=bp>;</span><span class=w> </span><span class=n>right</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>
</code></pre></div> <p>Notice that the pattern changes from <code>⟨h₀, h₁⟩</code> in the case of a conjunction to <code>h₀ | h₁</code> in the case of a disjunction. Think of the first pattern as matching against data the contains <em>both</em> an <code>h₀</code> and a <code>h₁</code>, whereas second pattern, with the bar, matches against data that contains <em>either</em> an <code>h₀</code> or <code>h₁</code>. In this case, because the two goals are separate, we have chosen to use the same name, <code>h</code>, in each case.</p> <p>The absolute value function is defined in such a way that we can immediately prove that <code>x ≥ 0</code> implies <code>|x| = x</code> (this is the theorem <code>abs_of_nonneg</code>) and <code>x &lt; 0</code> implies <code>|x| = -x</code> (this is <code>abs_of_neg</code>). The expression <code>le_or_gt 0 x</code> establishes <code>0 ≤ x ∨ x &lt; 0</code>, allowing us to split on those two cases.</p> <p>Lean also supports the computer scientists' pattern-matching syntax for disjunction. Now the <code>cases</code> tactic is more attractive, because it allows us to name each <code>case</code>, and name the hypothesis that is introduced closer to where it is used.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>cases</span><span class=w> </span><span class=n>le_or_gt</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>y</span>
<span class=w>  </span><span class=n>case</span><span class=w> </span><span class=n>inl</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>    </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_of_nonneg</span><span class=w> </span><span class=n>h</span><span class=o>]</span>
<span class=w>    </span><span class=n>intro</span><span class=w> </span><span class=n>h</span><span class=bp>;</span><span class=w> </span><span class=n>left</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>case</span><span class=w> </span><span class=n>inr</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>    </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_of_neg</span><span class=w> </span><span class=n>h</span><span class=o>]</span>
<span class=w>    </span><span class=n>intro</span><span class=w> </span><span class=n>h</span><span class=bp>;</span><span class=w> </span><span class=n>right</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>
</code></pre></div> <p>The names <code>inl</code> and <code>inr</code> are short for "intro left" and "intro right," respectively. Using <code>case</code> has the advantage that you can prove the cases in either order; Lean uses the tag to find the relevant goal. If you don't care about that, you can use <code>next</code>, or <code>match</code>, or even a pattern-matching <code>have</code>.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>cases</span><span class=w> </span><span class=n>le_or_gt</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>y</span>
<span class=w>  </span><span class=n>next</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>    </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_of_nonneg</span><span class=w> </span><span class=n>h</span><span class=o>]</span>
<span class=w>    </span><span class=n>intro</span><span class=w> </span><span class=n>h</span><span class=bp>;</span><span class=w> </span><span class=n>left</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>next</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>    </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_of_neg</span><span class=w> </span><span class=n>h</span><span class=o>]</span>
<span class=w>    </span><span class=n>intro</span><span class=w> </span><span class=n>h</span><span class=bp>;</span><span class=w> </span><span class=n>right</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=k>match</span><span class=w> </span><span class=n>le_or_gt</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=k>with</span>
<span class=w>    </span><span class=bp>|</span><span class=w> </span><span class=n>Or.inl</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>      </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_of_nonneg</span><span class=w> </span><span class=n>h</span><span class=o>]</span>
<span class=w>      </span><span class=n>intro</span><span class=w> </span><span class=n>h</span><span class=bp>;</span><span class=w> </span><span class=n>left</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>
<span class=w>    </span><span class=bp>|</span><span class=w> </span><span class=n>Or.inr</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=bp>=&gt;</span>
<span class=w>      </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>abs_of_neg</span><span class=w> </span><span class=n>h</span><span class=o>]</span>
<span class=w>      </span><span class=n>intro</span><span class=w> </span><span class=n>h</span><span class=bp>;</span><span class=w> </span><span class=n>right</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>h</span>
</code></pre></div> <p>In the case of <code>match</code>, we need to use the full names <code>Or.inl</code> and <code>Or.inr</code> of the canonical ways to prove a disjunction. In this textbook, we will generally use <code>rcases</code> to split on the cases of a disjunction.</p> <p>Try proving the triangle inequality using the first two theorems in the next snippet. They are given the same names they have in Mathlib.</p> <div class=highlight><pre><span></span><code><span class=kn>namespace</span><span class=w> </span><span class=n>MyAbs</span>

<span class=kd>theorem</span><span class=w> </span><span class=n>le_abs_self</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>theorem</span><span class=w> </span><span class=n>neg_le_abs_self</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>-</span><span class=n>x</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>theorem</span><span class=w> </span><span class=n>abs_add</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>In case you enjoyed these (pun intended) and you want more practice with disjunction, try these.</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>lt_abs</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>|</span><span class=n>y</span><span class=bp>|</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>theorem</span><span class=w> </span><span class=n>abs_lt</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>x</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>∧</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>You can also use <code>rcases</code> and <code>rintro</code> with nested disjunctions. When these result in a genuine case split with multiple goals, the patterns for each new goal are separated by a vertical bar.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>≠</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>lt_trichotomy</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>xlt</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=n>xeq</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=n>xgt</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>left</span>
<span class=w>    </span><span class=n>exact</span><span class=w> </span><span class=n>xlt</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>contradiction</span>
<span class=w>  </span><span class=bp>.</span><span class=w> </span><span class=n>right</span><span class=bp>;</span><span class=w> </span><span class=n>exact</span><span class=w> </span><span class=n>xgt</span>
</code></pre></div> <p>You can still nest patterns and use the <code>rfl</code> keyword to substitute equations:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>m</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>k</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=bp>∣</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>a</span><span class=o>,</span><span class=w> </span><span class=n>rfl</span><span class=o>⟩</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=o>⟨</span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=n>rfl</span><span class=o>⟩</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>mul_assoc</span><span class=o>]</span>
<span class=w>    </span><span class=n>apply</span><span class=w> </span><span class=n>dvd_mul_right</span>
<span class=w>  </span><span class=bp>.</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>mul_comm</span><span class=o>,</span><span class=w> </span><span class=n>mul_assoc</span><span class=o>]</span>
<span class=w>    </span><span class=n>apply</span><span class=w> </span><span class=n>dvd_mul_right</span>
</code></pre></div> <p>See if you can prove the following with a single (long) line. Use <code>rcases</code> to unpack the hypotheses and split on cases, and use a semicolon and <code>linarith</code> to solve each branch.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>z</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=o>,</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=mi>1</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=bp>≥</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>On the real numbers, an equation <code>x * y = 0</code> tells us that <code>x = 0</code> or <code>y = 0</code>. In Mathlib, this fact is known as <code>eq_zero_or_eq_zero_of_mul_eq_zero</code>, and it is another nice example of how a disjunction can arise. See if you can use it to prove the following:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>1</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=bp>-</span><span class=mi>1</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>Remember that you can use the <code>ring</code> tactic to help with calculations.</p> <p>In an arbitrary ring :math:<code>R</code>, an element :math:<code>x</code> such that :math:<code>x y = 0</code> for some nonzero :math:<code>y</code> is called a <em>left zero divisor</em>, an element :math:<code>x</code> such that :math:<code>y x = 0</code> for some nonzero :math:<code>y</code> is called a <em>right zero divisor</em>, and an element that is either a left or right zero divisor is called simply a <em>zero divisor</em>. The theorem <code>eq_zero_or_eq_zero_of_mul_eq_zero</code> says that the real numbers have no nontrivial zero divisors. A commutative ring with this property is called an <em>integral domain</em>. Your proofs of the two theorems above should work equally well in any integral domain:</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>R</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>[</span><span class=n>CommRing</span><span class=w> </span><span class=n>R</span><span class=o>]</span><span class=w> </span><span class=o>[</span><span class=n>IsDomain</span><span class=w> </span><span class=n>R</span><span class=o>]</span>
<span class=kd>variable</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>R</span><span class=o>)</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>1</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=bp>-</span><span class=mi>1</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>

<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=bp>-</span><span class=n>y</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>In fact, if you are careful, you can prove the first theorem without using commutativity of multiplication. In that case, it suffices to assume that <code>R</code> is a <code>Ring</code> instead of an <code>CommRing</code>.</p> <p>.. index:: excluded middle</p> <p>Sometimes in a proof we want to split on cases depending on whether some statement is true or not. For any proposition <code>P</code>, we can use <code>em P : P ∨ ¬ P</code>. The name <code>em</code> is short for "excluded middle."</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>P</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬¬</span><span class=n>P</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>cases</span><span class=w> </span><span class=n>em</span><span class=w> </span><span class=n>P</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>assumption</span>
<span class=w>  </span><span class=bp>.</span><span class=w> </span><span class=n>contradiction</span>
</code></pre></div> <p>Alternatively, you can use the <code>by_cases</code> tactic.</p> <div class=highlight><pre><span></span><code><span class=c1>-- EXAMPLES:</span>
<span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>P</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>¬¬</span><span class=n>P</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=n>by_cases</span><span class=w> </span><span class=n>h&#39;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>P</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>assumption</span>
<span class=w>  </span><span class=n>contradiction</span>
</code></pre></div> <p>Notice that the <code>by_cases</code> tactic lets you specify a label for the hypothesis that is introduced in each branch, in this case, <code>h' : P</code> in one and <code>h' : ¬ P</code> in the other. If you leave out the label, Lean uses <code>h</code> by default. Try proving the following equivalence, using <code>by_cases</code> to establish one direction.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>P</span><span class=w> </span><span class=n>Q</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Prop</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>Q</span><span class=w> </span><span class=bp>↔</span><span class=w> </span><span class=bp>¬</span><span class=n>P</span><span class=w> </span><span class=bp>∨</span><span class=w> </span><span class=n>Q</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <h2 id=sequences-and-convergence>Sequences and Convergence<a class=headerlink href=#sequences-and-convergence title="Permanent link">&para;</a></h2> <p>We now have enough skills at our disposal to do some real mathematics. In Lean, we can represent a sequence <span class=arithmatex>\(s_0, s_1, s_2, \ldots\)</span> of real numbers as a function <code>s : ℕ → ℝ</code>. Such a sequence is said to <em>converge</em> to a number :math:<code>a</code> if for every <span class=arithmatex>\(\varepsilon &gt; 0\)</span> there is a point beyond which the sequence remains within <span class=arithmatex>\(\varepsilon\)</span> of <span class=arithmatex>\(a\)</span>, that is, there is a number <span class=arithmatex>\(N\)</span> such that for every <span class=arithmatex>\(n \ge N\)</span>, <span class=arithmatex>\(| s_n - a | &lt; \varepsilon\)</span>. In Lean, we can render this as follows:</p> <div class=highlight><pre><span></span><code><span class=kd>def</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=o>(</span><span class=n>s</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=o>,</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>N</span><span class=o>,</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>≥</span><span class=w> </span><span class=n>N</span><span class=o>,</span><span class=w> </span><span class=bp>|</span><span class=n>s</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>a</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span>
</code></pre></div> <p>The notation <code>∀ ε &gt; 0, ...</code> is a convenient abbreviation for <code>∀ ε, ε &gt; 0 → ...</code>, and, similarly, <code>∀ n ≥ N, ...</code> abbreviates <code>∀ n, n ≥ N → ...</code>. And remember that <code>ε &gt; 0</code>, in turn, is defined as <code>0 &lt; ε</code>, and <code>n ≥ N</code> is defined as <code>N ≤ n</code>.</p> <p>.. index:: extensionality, ext, tactics ; ext</p> <p>In this section, we'll establish some properties of convergence. But first, we will discuss three tactics for working with equality that will prove useful. The first, the <code>ext</code> tactic, gives us a way of proving that two functions are equal. Let <span class=arithmatex>\(f(x) = x + 1\)</span> and <span class=arithmatex>\(g(x) = 1 + x\)</span> be functions from reals to reals. Then, of course, <span class=arithmatex>\(f = g\)</span>, because they return the same value for every <span class=arithmatex>\(x\)</span>. The <code>ext</code> tactic enables us to prove an equation between functions by proving that their values are the same at all the values of their arguments.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=o>(</span><span class=n>x</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>y</span><span class=o>)</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=o>)</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=bp>^</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>ext</span>
<span class=w>  </span><span class=n>ring</span>
</code></pre></div> <p>.. index:: congr, tactics ; congr</p> <p>We'll see later that <code>ext</code> is actually more general, and also one can specify the name of the variables that appear. For instance you can try to replace <code>ext</code> with <code>ext u v</code> in the above proof. The second tactic, the <code>congr</code> tactic, allows us to prove an equation between two expressions by reconciling the parts that are different:</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=bp>|</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>congr</span>
<span class=w>  </span><span class=n>ring</span>
</code></pre></div> <p>Here the <code>congr</code> tactic peels off the <code>abs</code> on each side, leaving us to prove <code>a = a - b + b</code>.</p> <p>.. index:: convert, tactics ; convert</p> <p>Finally, the <code>convert</code> tactic is used to apply a theorem to a goal when the conclusion of the theorem doesn't quite match. For example, suppose we want to prove <code>a &lt; a * a</code> from <code>1 &lt; a</code>. A theorem in the library, <code>mul_lt_mul_right</code>, will let us prove <code>1 * a &lt; a * a</code>. One possibility is to work backwards and rewrite the goal so that it has that form. Instead, the <code>convert</code> tactic lets us apply the theorem as it is, and leaves us with the task of proving the equations that are needed to make the goal match.</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>convert</span><span class=w> </span><span class=o>(</span><span class=n>mul_lt_mul_right</span><span class=w> </span><span class=n>_</span><span class=o>)</span><span class=bp>.</span><span class=mi>2</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>one_mul</span><span class=o>]</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>lt_trans</span><span class=w> </span><span class=n>zero_lt_one</span><span class=w> </span><span class=n>h</span>
</code></pre></div> <p>This example illustrates another useful trick: when we apply an expression with an underscore and Lean can't fill it in for us automatically, it simply leaves it for us as another goal.</p> <p>The following shows that any constant sequence <span class=arithmatex>\(a, a, a, \ldots\)</span> converges.</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>convergesTo_const</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=n>εpos</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=mi>0</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=n>nge</span>
<span class=w>  </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>sub_self</span><span class=o>,</span><span class=w> </span><span class=n>abs_zero</span><span class=o>]</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>εpos</span>
</code></pre></div> <p>Lean has a tactic, <code>simp</code>, which can often save you the trouble of carrying out steps like <code>rw [sub_self, abs_zero]</code> by hand. We will tell you more about it soon.</p> <p>For a more interesting theorem, let's show that if <code>s</code> converges to <code>a</code> and <code>t</code> converges to <code>b</code>, then <code>fun n ↦ s n + t n</code> converges to <code>a + b</code>. It is helpful to have a clear pen-and-paper proof in mind before you start writing a formal one. Given <code>ε</code> greater than <code>0</code>, the idea is to use the hypotheses to obtain an <code>Ns</code> such that beyond that point, <code>s</code> is within <code>ε / 2</code> of <code>a</code>, and an <code>Nt</code> such that beyond that point, <code>t</code> is within <code>ε / 2</code> of <code>b</code>. Then, whenever <code>n</code> is greater than or equal to the maximum of <code>Ns</code> and <code>Nt</code>, the sequence <code>fun n ↦ s n + t n</code> should be within <code>ε</code> of <code>a + b</code>. The following example begins to implement this strategy. See if you can finish it off.</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>convergesTo_add</span><span class=w> </span><span class=o>{</span><span class=n>s</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span>
<span class=w>      </span><span class=o>(</span><span class=n>cs</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ct</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>ConvergesTo</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=n>n</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=n>εpos</span>
<span class=w>  </span><span class=n>dsimp</span><span class=w> </span><span class=c1>-- this line is not needed but cleans up the goal a bit.</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>ε2pos</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=n>linarith</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>cs</span><span class=w> </span><span class=o>(</span><span class=n>ε</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=o>)</span><span class=w> </span><span class=n>ε2pos</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>Ns</span><span class=o>,</span><span class=w> </span><span class=n>hs</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>ct</span><span class=w> </span><span class=o>(</span><span class=n>ε</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=o>)</span><span class=w> </span><span class=n>ε2pos</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>Nt</span><span class=o>,</span><span class=w> </span><span class=n>ht</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>max</span><span class=w> </span><span class=n>Ns</span><span class=w> </span><span class=n>Nt</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>As hints, you can use <code>le_of_max_le_left</code> and <code>le_of_max_le_right</code>, and <code>norm_num</code> can prove <code>ε / 2 + ε / 2 = ε</code>. Also, it is helpful to use the <code>congr</code> tactic to show that <code>|s n + t n - (a + b)|</code> is equal to <code>|(s n - a) + (t n - b)|,</code> since then you can use the triangle inequality. Notice that we marked all the variables <code>s</code>, <code>t</code>, <code>a</code>, and <code>b</code> implicit because they can be inferred from the hypotheses.</p> <p>Proving the same theorem with multiplication in place of addition is tricky. We will get there by proving some auxiliary statements first. See if you can also finish off the next proof, which shows that if <code>s</code> converges to <code>a</code>, then <code>fun n ↦ c * s n</code> converges to <code>c * a</code>. It is helpful to split into cases depending on whether <code>c</code> is equal to zero or not. We have taken care of the zero case, and we have left you to prove the result with the extra assumption that <code>c</code> is nonzero.</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>convergesTo_mul_const</span><span class=w> </span><span class=o>{</span><span class=n>s</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>c</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>cs</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>ConvergesTo</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>n</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>c</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>by_cases</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=mi>0</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>convert</span><span class=w> </span><span class=n>convergesTo_const</span><span class=w> </span><span class=mi>0</span>
<span class=w>    </span><span class=bp>·</span><span class=w> </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>h</span><span class=o>]</span>
<span class=w>      </span><span class=n>ring</span>
<span class=w>    </span><span class=n>rw</span><span class=w> </span><span class=o>[</span><span class=n>h</span><span class=o>]</span>
<span class=w>    </span><span class=n>ring</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>acpos</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>|</span><span class=n>c</span><span class=bp>|</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>abs_pos.mpr</span><span class=w> </span><span class=n>h</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>The next theorem is also independently interesting: it shows that a convergent sequence is eventually bounded in absolute value. We have started you off; see if you can finish it.</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>exists_abs_le_of_convergesTo</span><span class=w> </span><span class=o>{</span><span class=n>s</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>cs</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=bp>∃</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=n>b</span><span class=o>,</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>n</span><span class=o>,</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=bp>|</span><span class=n>s</span><span class=w> </span><span class=n>n</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>cs</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=n>zero_lt_one</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>N</span><span class=o>,</span><span class=w> </span><span class=n>h</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>use</span><span class=w> </span><span class=n>N</span><span class=o>,</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=bp>|</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=mi>1</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>In fact, the theorem could be strengthened to assert that there is a bound <code>b</code> that holds for all values of <code>n</code>. But this version is strong enough for our purposes, and we will see at the end of this section that it holds more generally.</p> <p>The next lemma is auxiliary: we prove that if <code>s</code> converges to <code>a</code> and <code>t</code> converges to <code>0</code>, then <code>fun n ↦ s n * t n</code> converges to <code>0</code>. To do so, we use the previous theorem to find a <code>B</code> that bounds <code>s</code> beyond some point <code>N₀</code>. See if you can understand the strategy we have outlined and finish the proof.</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>aux</span><span class=w> </span><span class=o>{</span><span class=n>s</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>(</span><span class=n>cs</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ct</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=mi>0</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>ConvergesTo</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=n>n</span><span class=o>)</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>intro</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=n>εpos</span>
<span class=w>  </span><span class=n>dsimp</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>exists_abs_le_of_convergesTo</span><span class=w> </span><span class=n>cs</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>N₀</span><span class=o>,</span><span class=w> </span><span class=n>B</span><span class=o>,</span><span class=w> </span><span class=n>h₀</span><span class=o>⟩</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>Bpos</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>lt_of_le_of_lt</span><span class=w> </span><span class=o>(</span><span class=n>abs_nonneg</span><span class=w> </span><span class=n>_</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>h₀</span><span class=w> </span><span class=n>N₀</span><span class=w> </span><span class=o>(</span><span class=n>le_refl</span><span class=w> </span><span class=n>_</span><span class=o>))</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>pos₀</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>div_pos</span><span class=w> </span><span class=n>εpos</span><span class=w> </span><span class=n>Bpos</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>ct</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=n>pos₀</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>N₁</span><span class=o>,</span><span class=w> </span><span class=n>h₁</span><span class=o>⟩</span>
<span class=w>  </span><span class=gr>sorry</span>
</code></pre></div> <p>If you have made it this far, congratulations! We are now within striking distance of our theorem. The following proof finishes it off.</p> <div class=highlight><pre><span></span><code><span class=c1>-- BOTH:</span>
<span class=kd>theorem</span><span class=w> </span><span class=n>convergesTo_mul</span><span class=w> </span><span class=o>{</span><span class=n>s</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span>
<span class=w>      </span><span class=o>(</span><span class=n>cs</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>ct</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>ConvergesTo</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=n>n</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=o>(</span><span class=k>fun</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>↦</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>*</span><span class=w> </span><span class=o>(</span><span class=n>t</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>+</span><span class=w> </span><span class=bp>-</span><span class=n>b</span><span class=o>))</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>    </span><span class=n>apply</span><span class=w> </span><span class=n>aux</span><span class=w> </span><span class=n>cs</span>
<span class=w>    </span><span class=n>convert</span><span class=w> </span><span class=n>convergesTo_add</span><span class=w> </span><span class=n>ct</span><span class=w> </span><span class=o>(</span><span class=n>convergesTo_const</span><span class=w> </span><span class=o>(</span><span class=bp>-</span><span class=n>b</span><span class=o>))</span>
<span class=w>    </span><span class=n>ring</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>convergesTo_add</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=o>(</span><span class=n>convergesTo_mul_const</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>cs</span><span class=o>)</span>
<span class=w>  </span><span class=n>convert</span><span class=w> </span><span class=n>convergesTo_add</span><span class=w> </span><span class=n>h₁</span><span class=w> </span><span class=o>(</span><span class=n>convergesTo_mul_const</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=n>cs</span><span class=o>)</span><span class=w> </span><span class=n>using</span><span class=w> </span><span class=mi>1</span>
<span class=w>  </span><span class=bp>·</span><span class=w> </span><span class=n>ext</span><span class=bp>;</span><span class=w> </span><span class=n>ring</span>
<span class=w>  </span><span class=n>ring</span>
</code></pre></div> <p>For another challenging exercise, try filling out the following sketch of a proof that limits are unique. (If you are feeling bold, you can delete the proof sketch and try proving it from scratch.)</p> <div class=highlight><pre><span></span><code><span class=kd>theorem</span><span class=w> </span><span class=n>convergesTo_unique</span><span class=w> </span><span class=o>{</span><span class=n>s</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℕ</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span><span class=w> </span><span class=o>{</span><span class=n>a</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>}</span>
<span class=w>      </span><span class=o>(</span><span class=n>sa</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>a</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>sb</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ConvergesTo</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>b</span><span class=o>)</span><span class=w> </span><span class=o>:</span>
<span class=w>    </span><span class=n>a</span><span class=w> </span><span class=bp>=</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>by_contra</span><span class=w> </span><span class=n>abne</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>  </span><span class=k>let</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>εpos</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>    </span><span class=n>change</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span>
<span class=w>    </span><span class=n>linarith</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>sa</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=n>εpos</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>Na</span><span class=o>,</span><span class=w> </span><span class=n>hNa</span><span class=o>⟩</span>
<span class=w>  </span><span class=n>rcases</span><span class=w> </span><span class=n>sb</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=n>εpos</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>⟨</span><span class=n>Nb</span><span class=o>,</span><span class=w> </span><span class=n>hNb</span><span class=o>⟩</span>
<span class=w>  </span><span class=k>let</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>max</span><span class=w> </span><span class=n>Na</span><span class=w> </span><span class=n>Nb</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>absa</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>s</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>a</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=n>absb</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>s</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>  </span><span class=k>have</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=bp>|</span><span class=n>a</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>b</span><span class=bp>|</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span><span class=w> </span><span class=gr>sorry</span>
<span class=w>  </span><span class=n>exact</span><span class=w> </span><span class=n>lt_irrefl</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=n>this</span>
</code></pre></div> <p>We close the section with the observation that our proofs can be generalized. For example, the only properties that we have used of the natural numbers is that their structure carries a partial order with <code>min</code> and <code>max</code>. You can check that everything still works if you replace <code>ℕ</code> everywhere by any linear order <code>α</code>:</p> <div class=highlight><pre><span></span><code><span class=kd>variable</span><span class=w> </span><span class=o>{</span><span class=n>α</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kt>Type</span><span class=bp>*</span><span class=o>}</span><span class=w> </span><span class=o>[</span><span class=n>LinearOrder</span><span class=w> </span><span class=n>α</span><span class=o>]</span>

<span class=kd>def</span><span class=w> </span><span class=n>ConvergesTo&#39;</span><span class=w> </span><span class=o>(</span><span class=n>s</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>α</span><span class=w> </span><span class=bp>→</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>(</span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>ℝ</span><span class=o>)</span><span class=w> </span><span class=o>:=</span>
<span class=w>  </span><span class=bp>∀</span><span class=w> </span><span class=n>ε</span><span class=w> </span><span class=bp>&gt;</span><span class=w> </span><span class=mi>0</span><span class=o>,</span><span class=w> </span><span class=bp>∃</span><span class=w> </span><span class=n>N</span><span class=o>,</span><span class=w> </span><span class=bp>∀</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>≥</span><span class=w> </span><span class=n>N</span><span class=o>,</span><span class=w> </span><span class=bp>|</span><span class=n>s</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=bp>-</span><span class=w> </span><span class=n>a</span><span class=bp>|</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>ε</span>
</code></pre></div> <p>In :numref:<code>filters</code>, we will see that Mathlib has mechanisms for dealing with convergence in vastly more general terms, not only abstracting away particular features of the domain and codomain, but also abstracting over different types of convergence.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.fe8b6f2b.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>